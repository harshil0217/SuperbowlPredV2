{
  "cells": [
    {
      "cell_type": "code",
      "source": [
        "import pandas as pd\n",
        "import numpy as np\n",
        "from utils import filter_out_postseason\n",
        "from utils import simplify_date\n",
        "from utils import generate_opponent_wins\n",
        "from utils import team_map\n",
        "from utils import add_superbowl\n",
        "import seaborn as sns\n",
        "import matplotlib.pyplot as plt\n",
        "from sklearn.decomposition import PCA\n"
      ],
      "outputs": [],
      "execution_count": 1,
      "metadata": {
        "gather": {
          "logged": 1704761780361
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "offense = pd.read_csv(\"../data/raw/NFLRegSeasonOffenseStats.csv\")\n",
        "defense = pd.read_csv(\"../data/raw/NFLRegSeasonDefenseStats.csv\")"
      ],
      "outputs": [],
      "execution_count": 2,
      "metadata": {
        "gather": {
          "logged": 1704761780689
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "offense"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 3,
          "data": {
            "text/plain": "    iso_code              Team Conference     City       State  Year  Wins  \\\n0         BB     Buffalo Bills   AFC East  Buffalo    New York  2004     9   \n1         BB     Buffalo Bills   AFC East  Buffalo    New York  2005     5   \n2         BB     Buffalo Bills   AFC East  Buffalo    New York  2006     7   \n3         BB     Buffalo Bills   AFC East  Buffalo    New York  2007     7   \n4         BB     Buffalo Bills   AFC East  Buffalo    New York  2008     7   \n..       ...               ...        ...      ...         ...   ...   ...   \n603       SS  Seattle Seahawks   NFC West  Seattle  Washington  2018    10   \n604       SS  Seattle Seahawks   NFC West  Seattle  Washington  2019    11   \n605       SS  Seattle Seahawks   NFC West  Seattle  Washington  2020    12   \n606       SS  Seattle Seahawks   NFC West  Seattle  Washington  2021     7   \n607       SS  Seattle Seahawks   NFC West  Seattle  Washington  2022     9   \n\n     Losses  Ties  Passing_Attempts  ...  Receiving_Yards  Receiving_TDs  \\\n0         7     0               461  ...             3032             21   \n1        11     0               459  ...             2852             18   \n2         9     0               431  ...             3051             19   \n3         9     0               445  ...             2842             12   \n4         9     0               479  ...             3302             14   \n..      ...   ...               ...  ...              ...            ...   \n603       6     0               427  ...             3448             35   \n604       5     0               517  ...             4110             31   \n605       4     0               563  ...             4245             40   \n606      10     0               495  ...             3815             30   \n607       8     0               573  ...             4282             30   \n\n     Reciever_Fumbles  Two_Point_Conversions  Kick_Return_TDs  \\\n0                   4                      0                3   \n1                   1                      0                1   \n2                   3                      0                0   \n3                   4                      1                1   \n4                   7                      1                1   \n..                ...                    ...              ...   \n603                 4                      1                0   \n604                 8                      1                0   \n605                 3                      1                0   \n606                11                      1                1   \n607                 4                      0                0   \n\n     Punt_Return_TDs  Field_Goals_Attempts  Field_Goals_Made  \\\n0                  2                    28                24   \n1                  0                    35                29   \n2                  1                    25                23   \n3                  1                    27                24   \n4                  1                    38                30   \n..               ...                   ...               ...   \n603                0                    27                22   \n604                0                    28                23   \n605                0                    24                24   \n606                0                    23                17   \n607                0                    37                34   \n\n     Extra_Points_Attempts  Extra_Points_Made  \n0                       45                 45  \n1                       26                 26  \n2                       33                 33  \n3                       24                 24  \n4                       34                 34  \n..                     ...                ...  \n603                     51                 48  \n604                     44                 40  \n605                     53                 49  \n606                     47                 44  \n607                     42                 41  \n\n[608 rows x 29 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>iso_code</th>\n      <th>Team</th>\n      <th>Conference</th>\n      <th>City</th>\n      <th>State</th>\n      <th>Year</th>\n      <th>Wins</th>\n      <th>Losses</th>\n      <th>Ties</th>\n      <th>Passing_Attempts</th>\n      <th>...</th>\n      <th>Receiving_Yards</th>\n      <th>Receiving_TDs</th>\n      <th>Reciever_Fumbles</th>\n      <th>Two_Point_Conversions</th>\n      <th>Kick_Return_TDs</th>\n      <th>Punt_Return_TDs</th>\n      <th>Field_Goals_Attempts</th>\n      <th>Field_Goals_Made</th>\n      <th>Extra_Points_Attempts</th>\n      <th>Extra_Points_Made</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>BB</td>\n      <td>Buffalo Bills</td>\n      <td>AFC East</td>\n      <td>Buffalo</td>\n      <td>New York</td>\n      <td>2004</td>\n      <td>9</td>\n      <td>7</td>\n      <td>0</td>\n      <td>461</td>\n      <td>...</td>\n      <td>3032</td>\n      <td>21</td>\n      <td>4</td>\n      <td>0</td>\n      <td>3</td>\n      <td>2</td>\n      <td>28</td>\n      <td>24</td>\n      <td>45</td>\n      <td>45</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>BB</td>\n      <td>Buffalo Bills</td>\n      <td>AFC East</td>\n      <td>Buffalo</td>\n      <td>New York</td>\n      <td>2005</td>\n      <td>5</td>\n      <td>11</td>\n      <td>0</td>\n      <td>459</td>\n      <td>...</td>\n      <td>2852</td>\n      <td>18</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>35</td>\n      <td>29</td>\n      <td>26</td>\n      <td>26</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>BB</td>\n      <td>Buffalo Bills</td>\n      <td>AFC East</td>\n      <td>Buffalo</td>\n      <td>New York</td>\n      <td>2006</td>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>431</td>\n      <td>...</td>\n      <td>3051</td>\n      <td>19</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>25</td>\n      <td>23</td>\n      <td>33</td>\n      <td>33</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>BB</td>\n      <td>Buffalo Bills</td>\n      <td>AFC East</td>\n      <td>Buffalo</td>\n      <td>New York</td>\n      <td>2007</td>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>445</td>\n      <td>...</td>\n      <td>2842</td>\n      <td>12</td>\n      <td>4</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>27</td>\n      <td>24</td>\n      <td>24</td>\n      <td>24</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>BB</td>\n      <td>Buffalo Bills</td>\n      <td>AFC East</td>\n      <td>Buffalo</td>\n      <td>New York</td>\n      <td>2008</td>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>479</td>\n      <td>...</td>\n      <td>3302</td>\n      <td>14</td>\n      <td>7</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>38</td>\n      <td>30</td>\n      <td>34</td>\n      <td>34</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>603</th>\n      <td>SS</td>\n      <td>Seattle Seahawks</td>\n      <td>NFC West</td>\n      <td>Seattle</td>\n      <td>Washington</td>\n      <td>2018</td>\n      <td>10</td>\n      <td>6</td>\n      <td>0</td>\n      <td>427</td>\n      <td>...</td>\n      <td>3448</td>\n      <td>35</td>\n      <td>4</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>27</td>\n      <td>22</td>\n      <td>51</td>\n      <td>48</td>\n    </tr>\n    <tr>\n      <th>604</th>\n      <td>SS</td>\n      <td>Seattle Seahawks</td>\n      <td>NFC West</td>\n      <td>Seattle</td>\n      <td>Washington</td>\n      <td>2019</td>\n      <td>11</td>\n      <td>5</td>\n      <td>0</td>\n      <td>517</td>\n      <td>...</td>\n      <td>4110</td>\n      <td>31</td>\n      <td>8</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>28</td>\n      <td>23</td>\n      <td>44</td>\n      <td>40</td>\n    </tr>\n    <tr>\n      <th>605</th>\n      <td>SS</td>\n      <td>Seattle Seahawks</td>\n      <td>NFC West</td>\n      <td>Seattle</td>\n      <td>Washington</td>\n      <td>2020</td>\n      <td>12</td>\n      <td>4</td>\n      <td>0</td>\n      <td>563</td>\n      <td>...</td>\n      <td>4245</td>\n      <td>40</td>\n      <td>3</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>24</td>\n      <td>24</td>\n      <td>53</td>\n      <td>49</td>\n    </tr>\n    <tr>\n      <th>606</th>\n      <td>SS</td>\n      <td>Seattle Seahawks</td>\n      <td>NFC West</td>\n      <td>Seattle</td>\n      <td>Washington</td>\n      <td>2021</td>\n      <td>7</td>\n      <td>10</td>\n      <td>0</td>\n      <td>495</td>\n      <td>...</td>\n      <td>3815</td>\n      <td>30</td>\n      <td>11</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>23</td>\n      <td>17</td>\n      <td>47</td>\n      <td>44</td>\n    </tr>\n    <tr>\n      <th>607</th>\n      <td>SS</td>\n      <td>Seattle Seahawks</td>\n      <td>NFC West</td>\n      <td>Seattle</td>\n      <td>Washington</td>\n      <td>2022</td>\n      <td>9</td>\n      <td>8</td>\n      <td>0</td>\n      <td>573</td>\n      <td>...</td>\n      <td>4282</td>\n      <td>30</td>\n      <td>4</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>37</td>\n      <td>34</td>\n      <td>42</td>\n      <td>41</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 29 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 3,
      "metadata": {
        "gather": {
          "logged": 1704761780978
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "offense = offense.drop([\"iso_code\", \"Conference\", \"City\", \"State\"], axis = 1)\n",
        "defense = defense.drop([\"iso_code\", \"Conference\", \"City\", \"State\", \"Wins\", \"Losses\", \"Ties\"], axis = 1)"
      ],
      "outputs": [],
      "execution_count": 4,
      "metadata": {
        "gather": {
          "logged": 1704761781221
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "offense.columns"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 5,
          "data": {
            "text/plain": "Index(['Team', 'Year', 'Wins', 'Losses', 'Ties', 'Passing_Attempts',\n       'Passing_Completions', 'Passing_Yards', 'Passing_TDs',\n       'Interceptions_Thrown', 'Rushing _Attempts', 'Rushing_Yards',\n       'Rushing_TDs', 'Rushing_Fumbles', 'Receptions', 'Receiving_Yards',\n       'Receiving_TDs', 'Reciever_Fumbles', 'Two_Point_Conversions',\n       'Kick_Return_TDs', 'Punt_Return_TDs', 'Field_Goals_Attempts',\n       'Field_Goals_Made', 'Extra_Points_Attempts', 'Extra_Points_Made'],\n      dtype='object')"
          },
          "metadata": {}
        }
      ],
      "execution_count": 5,
      "metadata": {
        "gather": {
          "logged": 1704761781501
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "offense = offense.set_index([\"Team\", \"Year\"])\n",
        "defense = defense.set_index([\"Team\", \"Year\"])"
      ],
      "outputs": [],
      "execution_count": 6,
      "metadata": {
        "gather": {
          "logged": 1704761781724
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = pd.concat([offense, defense], axis = 1)"
      ],
      "outputs": [],
      "execution_count": 7,
      "metadata": {
        "gather": {
          "logged": 1704761781956
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 8,
          "data": {
            "text/plain": "                       Wins  Losses  Ties  Passing_Attempts  \\\nTeam             Year                                         \nBuffalo Bills    2004     9       7     0               461   \n                 2005     5      11     0               459   \n                 2006     7       9     0               431   \n                 2007     7       9     0               445   \n                 2008     7       9     0               479   \n...                     ...     ...   ...               ...   \nSeattle Seahawks 2018    10       6     0               427   \n                 2019    11       5     0               517   \n                 2020    12       4     0               563   \n                 2021     7      10     0               495   \n                 2022     9       8     0               573   \n\n                       Passing_Completions  Passing_Yards  Passing_TDs  \\\nTeam             Year                                                    \nBuffalo Bills    2004                  262           3032           21   \n                 2005                  269           2852           18   \n                 2006                  268           3051           19   \n                 2007                  263           2842           12   \n                 2008                  309           3302           14   \n...                                    ...            ...          ...   \nSeattle Seahawks 2018                  280           3448           35   \n                 2019                  341           4110           31   \n                 2020                  388           4245           40   \n                 2021                  324           3815           30   \n                 2022                  399           4282           30   \n\n                       Interceptions_Thrown  Rushing _Attempts  Rushing_Yards  \\\nTeam             Year                                                           \nBuffalo Bills    2004                    17                483           1874   \n                 2005                    16                428           1607   \n                 2006                    14                420           1552   \n                 2007                    14                448           1800   \n                 2008                    15                439           1842   \n...                                     ...                ...            ...   \nSeattle Seahawks 2018                     7                534           2560   \n                 2019                     6                481           2200   \n                 2020                    13                411           1971   \n                 2021                     7                413           2074   \n                 2022                    12                425           2042   \n\n                       ...  Assisted_Tackles  Sacks  Tackles_For_Loss  \\\nTeam             Year  ...                                              \nBuffalo Bills    2004  ...               377     45               0.0   \n                 2005  ...               357     38               0.0   \n                 2006  ...               368     40               0.0   \n                 2007  ...               262     26               0.0   \n                 2008  ...               227     24               0.0   \n...                    ...               ...    ...               ...   \nSeattle Seahawks 2018  ...               260     43              81.5   \n                 2019  ...               390     28              71.5   \n                 2020  ...               329     46             102.0   \n                 2021  ...               536     34              68.0   \n                 2022  ...               417     45              75.0   \n\n                       Pass_Deflections  Interceptions  Interception_TDs  \\\nTeam             Year                                                      \nBuffalo Bills    2004               225             24                 4   \n                 2005               189             17                 1   \n                 2006               189             13                 2   \n                 2007                80             18                 2   \n                 2008                73             10                 3   \n...                                 ...            ...               ...   \nSeattle Seahawks 2018                60             12                 1   \n                 2019                74             16                 2   \n                 2020                79             14                 0   \n                 2021                80             11                 0   \n                 2022                81             14                 1   \n\n                       Forced_Fumbles  Fumbles_Recovered  Fumble__TDs  \\\nTeam             Year                                                   \nBuffalo Bills    2004              21                  0            0   \n                 2005              16                  0            0   \n                 2006              17                  0            2   \n                 2007              12                  0            1   \n                 2008              15                  0            0   \n...                               ...                ...          ...   \nSeattle Seahawks 2018              21                 14            1   \n                 2019              19                 16            1   \n                 2020              14                  8            0   \n                 2021              11                  7            0   \n                 2022              21                 11            0   \n\n                       Kicks_Blocked  \nTeam             Year                 \nBuffalo Bills    2004              1  \n                 2005              0  \n                 2006              1  \n                 2007              0  \n                 2008              1  \n...                              ...  \nSeattle Seahawks 2018              1  \n                 2019              3  \n                 2020              2  \n                 2021              1  \n                 2022              1  \n\n[608 rows x 34 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>Wins</th>\n      <th>Losses</th>\n      <th>Ties</th>\n      <th>Passing_Attempts</th>\n      <th>Passing_Completions</th>\n      <th>Passing_Yards</th>\n      <th>Passing_TDs</th>\n      <th>Interceptions_Thrown</th>\n      <th>Rushing _Attempts</th>\n      <th>Rushing_Yards</th>\n      <th>...</th>\n      <th>Assisted_Tackles</th>\n      <th>Sacks</th>\n      <th>Tackles_For_Loss</th>\n      <th>Pass_Deflections</th>\n      <th>Interceptions</th>\n      <th>Interception_TDs</th>\n      <th>Forced_Fumbles</th>\n      <th>Fumbles_Recovered</th>\n      <th>Fumble__TDs</th>\n      <th>Kicks_Blocked</th>\n    </tr>\n    <tr>\n      <th>Team</th>\n      <th>Year</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">Buffalo Bills</th>\n      <th>2004</th>\n      <td>9</td>\n      <td>7</td>\n      <td>0</td>\n      <td>461</td>\n      <td>262</td>\n      <td>3032</td>\n      <td>21</td>\n      <td>17</td>\n      <td>483</td>\n      <td>1874</td>\n      <td>...</td>\n      <td>377</td>\n      <td>45</td>\n      <td>0.0</td>\n      <td>225</td>\n      <td>24</td>\n      <td>4</td>\n      <td>21</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2005</th>\n      <td>5</td>\n      <td>11</td>\n      <td>0</td>\n      <td>459</td>\n      <td>269</td>\n      <td>2852</td>\n      <td>18</td>\n      <td>16</td>\n      <td>428</td>\n      <td>1607</td>\n      <td>...</td>\n      <td>357</td>\n      <td>38</td>\n      <td>0.0</td>\n      <td>189</td>\n      <td>17</td>\n      <td>1</td>\n      <td>16</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2006</th>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>431</td>\n      <td>268</td>\n      <td>3051</td>\n      <td>19</td>\n      <td>14</td>\n      <td>420</td>\n      <td>1552</td>\n      <td>...</td>\n      <td>368</td>\n      <td>40</td>\n      <td>0.0</td>\n      <td>189</td>\n      <td>13</td>\n      <td>2</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2007</th>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>445</td>\n      <td>263</td>\n      <td>2842</td>\n      <td>12</td>\n      <td>14</td>\n      <td>448</td>\n      <td>1800</td>\n      <td>...</td>\n      <td>262</td>\n      <td>26</td>\n      <td>0.0</td>\n      <td>80</td>\n      <td>18</td>\n      <td>2</td>\n      <td>12</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2008</th>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>479</td>\n      <td>309</td>\n      <td>3302</td>\n      <td>14</td>\n      <td>15</td>\n      <td>439</td>\n      <td>1842</td>\n      <td>...</td>\n      <td>227</td>\n      <td>24</td>\n      <td>0.0</td>\n      <td>73</td>\n      <td>10</td>\n      <td>3</td>\n      <td>15</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">Seattle Seahawks</th>\n      <th>2018</th>\n      <td>10</td>\n      <td>6</td>\n      <td>0</td>\n      <td>427</td>\n      <td>280</td>\n      <td>3448</td>\n      <td>35</td>\n      <td>7</td>\n      <td>534</td>\n      <td>2560</td>\n      <td>...</td>\n      <td>260</td>\n      <td>43</td>\n      <td>81.5</td>\n      <td>60</td>\n      <td>12</td>\n      <td>1</td>\n      <td>21</td>\n      <td>14</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2019</th>\n      <td>11</td>\n      <td>5</td>\n      <td>0</td>\n      <td>517</td>\n      <td>341</td>\n      <td>4110</td>\n      <td>31</td>\n      <td>6</td>\n      <td>481</td>\n      <td>2200</td>\n      <td>...</td>\n      <td>390</td>\n      <td>28</td>\n      <td>71.5</td>\n      <td>74</td>\n      <td>16</td>\n      <td>2</td>\n      <td>19</td>\n      <td>16</td>\n      <td>1</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2020</th>\n      <td>12</td>\n      <td>4</td>\n      <td>0</td>\n      <td>563</td>\n      <td>388</td>\n      <td>4245</td>\n      <td>40</td>\n      <td>13</td>\n      <td>411</td>\n      <td>1971</td>\n      <td>...</td>\n      <td>329</td>\n      <td>46</td>\n      <td>102.0</td>\n      <td>79</td>\n      <td>14</td>\n      <td>0</td>\n      <td>14</td>\n      <td>8</td>\n      <td>0</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2021</th>\n      <td>7</td>\n      <td>10</td>\n      <td>0</td>\n      <td>495</td>\n      <td>324</td>\n      <td>3815</td>\n      <td>30</td>\n      <td>7</td>\n      <td>413</td>\n      <td>2074</td>\n      <td>...</td>\n      <td>536</td>\n      <td>34</td>\n      <td>68.0</td>\n      <td>80</td>\n      <td>11</td>\n      <td>0</td>\n      <td>11</td>\n      <td>7</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2022</th>\n      <td>9</td>\n      <td>8</td>\n      <td>0</td>\n      <td>573</td>\n      <td>399</td>\n      <td>4282</td>\n      <td>30</td>\n      <td>12</td>\n      <td>425</td>\n      <td>2042</td>\n      <td>...</td>\n      <td>417</td>\n      <td>45</td>\n      <td>75.0</td>\n      <td>81</td>\n      <td>14</td>\n      <td>1</td>\n      <td>21</td>\n      <td>11</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 34 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 8,
      "metadata": {
        "gather": {
          "logged": 1704761782182
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = pd.read_csv(\"../data/raw/nfl_win_loss.csv\")\n",
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 9,
          "data": {
            "text/plain": "           date      away     home  first_downs_away  first_downs_home  \\\n0      9/5/2002     49ers   Giants                13                21   \n1      9/8/2002      Jets    Bills                18                26   \n2      9/8/2002   Vikings    Bears                19                20   \n3      9/8/2002  Chargers  Bengals                27                13   \n4      9/8/2002    Chiefs   Browns                24                24   \n...         ...       ...      ...               ...               ...   \n5636  1/22/2023   Bengals    Bills                30                19   \n5637  1/22/2023   Cowboys    49ers                15                21   \n5638  1/29/2023     49ers   Eagles                11                25   \n5639  1/29/2023   Bengals   Chiefs                18                23   \n5640  2/12/2023    Chiefs   Eagles                21                25   \n\n     third_downs_away third_downs_home fourth_downs_away fourth_downs_home  \\\n0              12-Apr           16-Sep               0-0               0-1   \n1               8-Feb           17-Jul               0-0             2-Feb   \n2              13-May           13-Jul               0-0               0-0   \n3              10-Jun           11-Apr               0-0               0-0   \n4              11-May           11-Apr               0-0               0-0   \n...               ...              ...               ...               ...   \n5636           10-Jun           12-May               0-0             2-Jan   \n5637           15-May           14-Jul             2-Feb               0-0   \n5638            8-Feb           15-May               0-2             3-Mar   \n5639           14-Jun           14-Jul             1-Jan             1-Jan   \n5640            8-Apr           18-Nov               0-0             2-Feb   \n\n      passing_yards_away  ...  redzone_away  redzone_home  drives_away  \\\n0                    166  ...           0-8           0-6           13   \n1                    193  ...           0-9           0-8           17   \n2                    228  ...           0-7           0-6           17   \n3                    160  ...           0-7           0-5           11   \n4                    276  ...          0-10          0-10           20   \n...                  ...  ...           ...           ...          ...   \n5636                 240  ...         4-Feb         3-Jan            9   \n5637                 206  ...         3-Jan         3-Jan           10   \n5638                  83  ...           0-0         6-Apr           10   \n5639                 238  ...         3-Jan         3-Feb           11   \n5640                 182  ...         5-Apr         5-Mar            8   \n\n      drives_home  def_st_td_away def_st_td_home possession_away  \\\n0              15               0              0        27:32:00   \n1              18               2              0           21:06   \n2              17               0              0        31:31:00   \n3              15               0              0        37:48:00   \n4              17               0              0        30:16:00   \n...           ...             ...            ...             ...   \n5636            8               0              0        33:54:00   \n5637            9               0              0        27:07:00   \n5638           10               0              0           22:34   \n5639           10               0              0        27:09:00   \n5640           10               1              0        24:13:00   \n\n     possession_home score_away  score_home  \n0           32:28:00         16          13  \n1           39:08:00         37          31  \n2           28:29:00         23          27  \n3              22:12         34           6  \n4           29:44:00         40          39  \n...              ...        ...         ...  \n5636        26:06:00         27          10  \n5637        32:53:00         12          19  \n5638        37:26:00          7          31  \n5639        32:51:00         20          23  \n5640        35:47:00         38          35  \n\n[5641 rows x 39 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>away</th>\n      <th>home</th>\n      <th>first_downs_away</th>\n      <th>first_downs_home</th>\n      <th>third_downs_away</th>\n      <th>third_downs_home</th>\n      <th>fourth_downs_away</th>\n      <th>fourth_downs_home</th>\n      <th>passing_yards_away</th>\n      <th>...</th>\n      <th>redzone_away</th>\n      <th>redzone_home</th>\n      <th>drives_away</th>\n      <th>drives_home</th>\n      <th>def_st_td_away</th>\n      <th>def_st_td_home</th>\n      <th>possession_away</th>\n      <th>possession_home</th>\n      <th>score_away</th>\n      <th>score_home</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9/5/2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>13</td>\n      <td>21</td>\n      <td>12-Apr</td>\n      <td>16-Sep</td>\n      <td>0-0</td>\n      <td>0-1</td>\n      <td>166</td>\n      <td>...</td>\n      <td>0-8</td>\n      <td>0-6</td>\n      <td>13</td>\n      <td>15</td>\n      <td>0</td>\n      <td>0</td>\n      <td>27:32:00</td>\n      <td>32:28:00</td>\n      <td>16</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9/8/2002</td>\n      <td>Jets</td>\n      <td>Bills</td>\n      <td>18</td>\n      <td>26</td>\n      <td>8-Feb</td>\n      <td>17-Jul</td>\n      <td>0-0</td>\n      <td>2-Feb</td>\n      <td>193</td>\n      <td>...</td>\n      <td>0-9</td>\n      <td>0-8</td>\n      <td>17</td>\n      <td>18</td>\n      <td>2</td>\n      <td>0</td>\n      <td>21:06</td>\n      <td>39:08:00</td>\n      <td>37</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9/8/2002</td>\n      <td>Vikings</td>\n      <td>Bears</td>\n      <td>19</td>\n      <td>20</td>\n      <td>13-May</td>\n      <td>13-Jul</td>\n      <td>0-0</td>\n      <td>0-0</td>\n      <td>228</td>\n      <td>...</td>\n      <td>0-7</td>\n      <td>0-6</td>\n      <td>17</td>\n      <td>17</td>\n      <td>0</td>\n      <td>0</td>\n      <td>31:31:00</td>\n      <td>28:29:00</td>\n      <td>23</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>9/8/2002</td>\n      <td>Chargers</td>\n      <td>Bengals</td>\n      <td>27</td>\n      <td>13</td>\n      <td>10-Jun</td>\n      <td>11-Apr</td>\n      <td>0-0</td>\n      <td>0-0</td>\n      <td>160</td>\n      <td>...</td>\n      <td>0-7</td>\n      <td>0-5</td>\n      <td>11</td>\n      <td>15</td>\n      <td>0</td>\n      <td>0</td>\n      <td>37:48:00</td>\n      <td>22:12</td>\n      <td>34</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>9/8/2002</td>\n      <td>Chiefs</td>\n      <td>Browns</td>\n      <td>24</td>\n      <td>24</td>\n      <td>11-May</td>\n      <td>11-Apr</td>\n      <td>0-0</td>\n      <td>0-0</td>\n      <td>276</td>\n      <td>...</td>\n      <td>0-10</td>\n      <td>0-10</td>\n      <td>20</td>\n      <td>17</td>\n      <td>0</td>\n      <td>0</td>\n      <td>30:16:00</td>\n      <td>29:44:00</td>\n      <td>40</td>\n      <td>39</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5636</th>\n      <td>1/22/2023</td>\n      <td>Bengals</td>\n      <td>Bills</td>\n      <td>30</td>\n      <td>19</td>\n      <td>10-Jun</td>\n      <td>12-May</td>\n      <td>0-0</td>\n      <td>2-Jan</td>\n      <td>240</td>\n      <td>...</td>\n      <td>4-Feb</td>\n      <td>3-Jan</td>\n      <td>9</td>\n      <td>8</td>\n      <td>0</td>\n      <td>0</td>\n      <td>33:54:00</td>\n      <td>26:06:00</td>\n      <td>27</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>5637</th>\n      <td>1/22/2023</td>\n      <td>Cowboys</td>\n      <td>49ers</td>\n      <td>15</td>\n      <td>21</td>\n      <td>15-May</td>\n      <td>14-Jul</td>\n      <td>2-Feb</td>\n      <td>0-0</td>\n      <td>206</td>\n      <td>...</td>\n      <td>3-Jan</td>\n      <td>3-Jan</td>\n      <td>10</td>\n      <td>9</td>\n      <td>0</td>\n      <td>0</td>\n      <td>27:07:00</td>\n      <td>32:53:00</td>\n      <td>12</td>\n      <td>19</td>\n    </tr>\n    <tr>\n      <th>5638</th>\n      <td>1/29/2023</td>\n      <td>49ers</td>\n      <td>Eagles</td>\n      <td>11</td>\n      <td>25</td>\n      <td>8-Feb</td>\n      <td>15-May</td>\n      <td>0-2</td>\n      <td>3-Mar</td>\n      <td>83</td>\n      <td>...</td>\n      <td>0-0</td>\n      <td>6-Apr</td>\n      <td>10</td>\n      <td>10</td>\n      <td>0</td>\n      <td>0</td>\n      <td>22:34</td>\n      <td>37:26:00</td>\n      <td>7</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>5639</th>\n      <td>1/29/2023</td>\n      <td>Bengals</td>\n      <td>Chiefs</td>\n      <td>18</td>\n      <td>23</td>\n      <td>14-Jun</td>\n      <td>14-Jul</td>\n      <td>1-Jan</td>\n      <td>1-Jan</td>\n      <td>238</td>\n      <td>...</td>\n      <td>3-Jan</td>\n      <td>3-Feb</td>\n      <td>11</td>\n      <td>10</td>\n      <td>0</td>\n      <td>0</td>\n      <td>27:09:00</td>\n      <td>32:51:00</td>\n      <td>20</td>\n      <td>23</td>\n    </tr>\n    <tr>\n      <th>5640</th>\n      <td>2/12/2023</td>\n      <td>Chiefs</td>\n      <td>Eagles</td>\n      <td>21</td>\n      <td>25</td>\n      <td>8-Apr</td>\n      <td>18-Nov</td>\n      <td>0-0</td>\n      <td>2-Feb</td>\n      <td>182</td>\n      <td>...</td>\n      <td>5-Apr</td>\n      <td>5-Mar</td>\n      <td>8</td>\n      <td>10</td>\n      <td>1</td>\n      <td>0</td>\n      <td>24:13:00</td>\n      <td>35:47:00</td>\n      <td>38</td>\n      <td>35</td>\n    </tr>\n  </tbody>\n</table>\n<p>5641 rows × 39 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 9,
      "metadata": {
        "gather": {
          "logged": 1704761782634
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss[[\"date\",\"away\", \"home\", \"score_away\", \"score_home\"]]"
      ],
      "outputs": [],
      "execution_count": 10,
      "metadata": {
        "gather": {
          "logged": 1704761782869
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 11,
          "data": {
            "text/plain": "           date      away     home  score_away  score_home\n0      9/5/2002     49ers   Giants          16          13\n1      9/8/2002      Jets    Bills          37          31\n2      9/8/2002   Vikings    Bears          23          27\n3      9/8/2002  Chargers  Bengals          34           6\n4      9/8/2002    Chiefs   Browns          40          39\n...         ...       ...      ...         ...         ...\n5636  1/22/2023   Bengals    Bills          27          10\n5637  1/22/2023   Cowboys    49ers          12          19\n5638  1/29/2023     49ers   Eagles           7          31\n5639  1/29/2023   Bengals   Chiefs          20          23\n5640  2/12/2023    Chiefs   Eagles          38          35\n\n[5641 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>away</th>\n      <th>home</th>\n      <th>score_away</th>\n      <th>score_home</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9/5/2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>16</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9/8/2002</td>\n      <td>Jets</td>\n      <td>Bills</td>\n      <td>37</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9/8/2002</td>\n      <td>Vikings</td>\n      <td>Bears</td>\n      <td>23</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>9/8/2002</td>\n      <td>Chargers</td>\n      <td>Bengals</td>\n      <td>34</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>9/8/2002</td>\n      <td>Chiefs</td>\n      <td>Browns</td>\n      <td>40</td>\n      <td>39</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5636</th>\n      <td>1/22/2023</td>\n      <td>Bengals</td>\n      <td>Bills</td>\n      <td>27</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>5637</th>\n      <td>1/22/2023</td>\n      <td>Cowboys</td>\n      <td>49ers</td>\n      <td>12</td>\n      <td>19</td>\n    </tr>\n    <tr>\n      <th>5638</th>\n      <td>1/29/2023</td>\n      <td>49ers</td>\n      <td>Eagles</td>\n      <td>7</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>5639</th>\n      <td>1/29/2023</td>\n      <td>Bengals</td>\n      <td>Chiefs</td>\n      <td>20</td>\n      <td>23</td>\n    </tr>\n    <tr>\n      <th>5640</th>\n      <td>2/12/2023</td>\n      <td>Chiefs</td>\n      <td>Eagles</td>\n      <td>38</td>\n      <td>35</td>\n    </tr>\n  </tbody>\n</table>\n<p>5641 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 11,
      "metadata": {
        "gather": {
          "logged": 1704761783114
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss2 = win_loss"
      ],
      "outputs": [],
      "execution_count": 12,
      "metadata": {
        "gather": {
          "logged": 1704761783338
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.rename(columns = {\"away\": \"team\", \"home\": \"opponent\", \"score_away\": \"score_team\", \"score_home\":\"score_opponent\"})"
      ],
      "outputs": [],
      "execution_count": 13,
      "metadata": {
        "gather": {
          "logged": 1704761783579
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 14,
          "data": {
            "text/plain": "           date      team opponent  score_team  score_opponent\n0      9/5/2002     49ers   Giants          16              13\n1      9/8/2002      Jets    Bills          37              31\n2      9/8/2002   Vikings    Bears          23              27\n3      9/8/2002  Chargers  Bengals          34               6\n4      9/8/2002    Chiefs   Browns          40              39\n...         ...       ...      ...         ...             ...\n5636  1/22/2023   Bengals    Bills          27              10\n5637  1/22/2023   Cowboys    49ers          12              19\n5638  1/29/2023     49ers   Eagles           7              31\n5639  1/29/2023   Bengals   Chiefs          20              23\n5640  2/12/2023    Chiefs   Eagles          38              35\n\n[5641 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>score_team</th>\n      <th>score_opponent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9/5/2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>16</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9/8/2002</td>\n      <td>Jets</td>\n      <td>Bills</td>\n      <td>37</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9/8/2002</td>\n      <td>Vikings</td>\n      <td>Bears</td>\n      <td>23</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>9/8/2002</td>\n      <td>Chargers</td>\n      <td>Bengals</td>\n      <td>34</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>9/8/2002</td>\n      <td>Chiefs</td>\n      <td>Browns</td>\n      <td>40</td>\n      <td>39</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5636</th>\n      <td>1/22/2023</td>\n      <td>Bengals</td>\n      <td>Bills</td>\n      <td>27</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>5637</th>\n      <td>1/22/2023</td>\n      <td>Cowboys</td>\n      <td>49ers</td>\n      <td>12</td>\n      <td>19</td>\n    </tr>\n    <tr>\n      <th>5638</th>\n      <td>1/29/2023</td>\n      <td>49ers</td>\n      <td>Eagles</td>\n      <td>7</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>5639</th>\n      <td>1/29/2023</td>\n      <td>Bengals</td>\n      <td>Chiefs</td>\n      <td>20</td>\n      <td>23</td>\n    </tr>\n    <tr>\n      <th>5640</th>\n      <td>2/12/2023</td>\n      <td>Chiefs</td>\n      <td>Eagles</td>\n      <td>38</td>\n      <td>35</td>\n    </tr>\n  </tbody>\n</table>\n<p>5641 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 14,
      "metadata": {
        "gather": {
          "logged": 1704761783976
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss2 = win_loss[[\"date\", \"opponent\", \"team\", \"score_opponent\", \"score_team\"]]"
      ],
      "outputs": [],
      "execution_count": 15,
      "metadata": {
        "gather": {
          "logged": 1704761784396
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss2"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 16,
          "data": {
            "text/plain": "           date opponent      team  score_opponent  score_team\n0      9/5/2002   Giants     49ers              13          16\n1      9/8/2002    Bills      Jets              31          37\n2      9/8/2002    Bears   Vikings              27          23\n3      9/8/2002  Bengals  Chargers               6          34\n4      9/8/2002   Browns    Chiefs              39          40\n...         ...      ...       ...             ...         ...\n5636  1/22/2023    Bills   Bengals              10          27\n5637  1/22/2023    49ers   Cowboys              19          12\n5638  1/29/2023   Eagles     49ers              31           7\n5639  1/29/2023   Chiefs   Bengals              23          20\n5640  2/12/2023   Eagles    Chiefs              35          38\n\n[5641 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>opponent</th>\n      <th>team</th>\n      <th>score_opponent</th>\n      <th>score_team</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9/5/2002</td>\n      <td>Giants</td>\n      <td>49ers</td>\n      <td>13</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9/8/2002</td>\n      <td>Bills</td>\n      <td>Jets</td>\n      <td>31</td>\n      <td>37</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9/8/2002</td>\n      <td>Bears</td>\n      <td>Vikings</td>\n      <td>27</td>\n      <td>23</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>9/8/2002</td>\n      <td>Bengals</td>\n      <td>Chargers</td>\n      <td>6</td>\n      <td>34</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>9/8/2002</td>\n      <td>Browns</td>\n      <td>Chiefs</td>\n      <td>39</td>\n      <td>40</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5636</th>\n      <td>1/22/2023</td>\n      <td>Bills</td>\n      <td>Bengals</td>\n      <td>10</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>5637</th>\n      <td>1/22/2023</td>\n      <td>49ers</td>\n      <td>Cowboys</td>\n      <td>19</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>5638</th>\n      <td>1/29/2023</td>\n      <td>Eagles</td>\n      <td>49ers</td>\n      <td>31</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>5639</th>\n      <td>1/29/2023</td>\n      <td>Chiefs</td>\n      <td>Bengals</td>\n      <td>23</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>5640</th>\n      <td>2/12/2023</td>\n      <td>Eagles</td>\n      <td>Chiefs</td>\n      <td>35</td>\n      <td>38</td>\n    </tr>\n  </tbody>\n</table>\n<p>5641 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 16,
      "metadata": {
        "gather": {
          "logged": 1704761784710
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss2 = win_loss2.rename(columns = {\"opponent\":\"team\", \"team\":\"opponent\", \"score_opponent\":\"score_team\",\"score_team\":\"score_opponent\"})"
      ],
      "outputs": [],
      "execution_count": 17,
      "metadata": {
        "gather": {
          "logged": 1704761785042
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss2"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 18,
          "data": {
            "text/plain": "           date     team  opponent  score_team  score_opponent\n0      9/5/2002   Giants     49ers          13              16\n1      9/8/2002    Bills      Jets          31              37\n2      9/8/2002    Bears   Vikings          27              23\n3      9/8/2002  Bengals  Chargers           6              34\n4      9/8/2002   Browns    Chiefs          39              40\n...         ...      ...       ...         ...             ...\n5636  1/22/2023    Bills   Bengals          10              27\n5637  1/22/2023    49ers   Cowboys          19              12\n5638  1/29/2023   Eagles     49ers          31               7\n5639  1/29/2023   Chiefs   Bengals          23              20\n5640  2/12/2023   Eagles    Chiefs          35              38\n\n[5641 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>score_team</th>\n      <th>score_opponent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9/5/2002</td>\n      <td>Giants</td>\n      <td>49ers</td>\n      <td>13</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9/8/2002</td>\n      <td>Bills</td>\n      <td>Jets</td>\n      <td>31</td>\n      <td>37</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9/8/2002</td>\n      <td>Bears</td>\n      <td>Vikings</td>\n      <td>27</td>\n      <td>23</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>9/8/2002</td>\n      <td>Bengals</td>\n      <td>Chargers</td>\n      <td>6</td>\n      <td>34</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>9/8/2002</td>\n      <td>Browns</td>\n      <td>Chiefs</td>\n      <td>39</td>\n      <td>40</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5636</th>\n      <td>1/22/2023</td>\n      <td>Bills</td>\n      <td>Bengals</td>\n      <td>10</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>5637</th>\n      <td>1/22/2023</td>\n      <td>49ers</td>\n      <td>Cowboys</td>\n      <td>19</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>5638</th>\n      <td>1/29/2023</td>\n      <td>Eagles</td>\n      <td>49ers</td>\n      <td>31</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>5639</th>\n      <td>1/29/2023</td>\n      <td>Chiefs</td>\n      <td>Bengals</td>\n      <td>23</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>5640</th>\n      <td>2/12/2023</td>\n      <td>Eagles</td>\n      <td>Chiefs</td>\n      <td>35</td>\n      <td>38</td>\n    </tr>\n  </tbody>\n</table>\n<p>5641 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 18,
      "metadata": {
        "gather": {
          "logged": 1704761785443
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = pd.concat([win_loss, win_loss2])"
      ],
      "outputs": [],
      "execution_count": 19,
      "metadata": {
        "gather": {
          "logged": 1704761785770
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 20,
          "data": {
            "text/plain": "           date      team opponent  score_team  score_opponent\n0      9/5/2002     49ers   Giants          16              13\n1      9/8/2002      Jets    Bills          37              31\n2      9/8/2002   Vikings    Bears          23              27\n3      9/8/2002  Chargers  Bengals          34               6\n4      9/8/2002    Chiefs   Browns          40              39\n...         ...       ...      ...         ...             ...\n5636  1/22/2023     Bills  Bengals          10              27\n5637  1/22/2023     49ers  Cowboys          19              12\n5638  1/29/2023    Eagles    49ers          31               7\n5639  1/29/2023    Chiefs  Bengals          23              20\n5640  2/12/2023    Eagles   Chiefs          35              38\n\n[11282 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>score_team</th>\n      <th>score_opponent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>9/5/2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>16</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>9/8/2002</td>\n      <td>Jets</td>\n      <td>Bills</td>\n      <td>37</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>9/8/2002</td>\n      <td>Vikings</td>\n      <td>Bears</td>\n      <td>23</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>9/8/2002</td>\n      <td>Chargers</td>\n      <td>Bengals</td>\n      <td>34</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>9/8/2002</td>\n      <td>Chiefs</td>\n      <td>Browns</td>\n      <td>40</td>\n      <td>39</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5636</th>\n      <td>1/22/2023</td>\n      <td>Bills</td>\n      <td>Bengals</td>\n      <td>10</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>5637</th>\n      <td>1/22/2023</td>\n      <td>49ers</td>\n      <td>Cowboys</td>\n      <td>19</td>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>5638</th>\n      <td>1/29/2023</td>\n      <td>Eagles</td>\n      <td>49ers</td>\n      <td>31</td>\n      <td>7</td>\n    </tr>\n    <tr>\n      <th>5639</th>\n      <td>1/29/2023</td>\n      <td>Chiefs</td>\n      <td>Bengals</td>\n      <td>23</td>\n      <td>20</td>\n    </tr>\n    <tr>\n      <th>5640</th>\n      <td>2/12/2023</td>\n      <td>Eagles</td>\n      <td>Chiefs</td>\n      <td>35</td>\n      <td>38</td>\n    </tr>\n  </tbody>\n</table>\n<p>11282 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 20,
      "metadata": {
        "gather": {
          "logged": 1704761786126
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "dates = pd.to_datetime(win_loss[\"date\"])"
      ],
      "outputs": [],
      "execution_count": 21,
      "metadata": {
        "gather": {
          "logged": 1704761786466
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss[\"date\"] = dates"
      ],
      "outputs": [],
      "execution_count": 22,
      "metadata": {
        "gather": {
          "logged": 1704761786836
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = filter_out_postseason(win_loss, \"date\")\n",
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 23,
          "data": {
            "text/plain": "           date        team   opponent  score_team  score_opponent\n0    2002-09-05       49ers     Giants          16              13\n1    2002-09-08        Jets      Bills          37              31\n2    2002-09-08     Vikings      Bears          23              27\n3    2002-09-08    Chargers    Bengals          34               6\n4    2002-09-08      Chiefs     Browns          40              39\n...         ...         ...        ...         ...             ...\n5623 2023-01-08      Eagles     Giants          22              16\n5624 2023-01-08       49ers  Cardinals          38              13\n5625 2023-01-08    Seahawks       Rams          19              16\n5626 2023-01-08  Commanders    Cowboys          26               6\n5627 2023-01-08     Packers      Lions          16              20\n\n[10824 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>score_team</th>\n      <th>score_opponent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2002-09-05</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>16</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2002-09-08</td>\n      <td>Jets</td>\n      <td>Bills</td>\n      <td>37</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2002-09-08</td>\n      <td>Vikings</td>\n      <td>Bears</td>\n      <td>23</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2002-09-08</td>\n      <td>Chargers</td>\n      <td>Bengals</td>\n      <td>34</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2002-09-08</td>\n      <td>Chiefs</td>\n      <td>Browns</td>\n      <td>40</td>\n      <td>39</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5623</th>\n      <td>2023-01-08</td>\n      <td>Eagles</td>\n      <td>Giants</td>\n      <td>22</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>5624</th>\n      <td>2023-01-08</td>\n      <td>49ers</td>\n      <td>Cardinals</td>\n      <td>38</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>5625</th>\n      <td>2023-01-08</td>\n      <td>Seahawks</td>\n      <td>Rams</td>\n      <td>19</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>5626</th>\n      <td>2023-01-08</td>\n      <td>Commanders</td>\n      <td>Cowboys</td>\n      <td>26</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>5627</th>\n      <td>2023-01-08</td>\n      <td>Packers</td>\n      <td>Lions</td>\n      <td>16</td>\n      <td>20</td>\n    </tr>\n  </tbody>\n</table>\n<p>10824 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 23,
      "metadata": {
        "gather": {
          "logged": 1704761787200
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = simplify_date(win_loss, \"date\")\n",
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 24,
          "data": {
            "text/plain": "      date        team   opponent  score_team  score_opponent\n0     2002       49ers     Giants          16              13\n1     2002        Jets      Bills          37              31\n2     2002     Vikings      Bears          23              27\n3     2002    Chargers    Bengals          34               6\n4     2002      Chiefs     Browns          40              39\n...    ...         ...        ...         ...             ...\n5623  2022      Eagles     Giants          22              16\n5624  2022       49ers  Cardinals          38              13\n5625  2022    Seahawks       Rams          19              16\n5626  2022  Commanders    Cowboys          26               6\n5627  2022     Packers      Lions          16              20\n\n[10824 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>score_team</th>\n      <th>score_opponent</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>16</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2002</td>\n      <td>Jets</td>\n      <td>Bills</td>\n      <td>37</td>\n      <td>31</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2002</td>\n      <td>Vikings</td>\n      <td>Bears</td>\n      <td>23</td>\n      <td>27</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2002</td>\n      <td>Chargers</td>\n      <td>Bengals</td>\n      <td>34</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2002</td>\n      <td>Chiefs</td>\n      <td>Browns</td>\n      <td>40</td>\n      <td>39</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5623</th>\n      <td>2022</td>\n      <td>Eagles</td>\n      <td>Giants</td>\n      <td>22</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>5624</th>\n      <td>2022</td>\n      <td>49ers</td>\n      <td>Cardinals</td>\n      <td>38</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>5625</th>\n      <td>2022</td>\n      <td>Seahawks</td>\n      <td>Rams</td>\n      <td>19</td>\n      <td>16</td>\n    </tr>\n    <tr>\n      <th>5626</th>\n      <td>2022</td>\n      <td>Commanders</td>\n      <td>Cowboys</td>\n      <td>26</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>5627</th>\n      <td>2022</td>\n      <td>Packers</td>\n      <td>Lions</td>\n      <td>16</td>\n      <td>20</td>\n    </tr>\n  </tbody>\n</table>\n<p>10824 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 24,
      "metadata": {
        "gather": {
          "logged": 1704761789874
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss[\"win\"] = np.zeros(len(win_loss))"
      ],
      "outputs": [],
      "execution_count": 25,
      "metadata": {
        "gather": {
          "logged": 1704761790099
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss[\"win\"] = win_loss[\"win\"].mask(win_loss[\"score_team\"] > win_loss[\"score_opponent\"],1)"
      ],
      "outputs": [],
      "execution_count": 26,
      "metadata": {
        "gather": {
          "logged": 1704761790388
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 27,
          "data": {
            "text/plain": "      date        team   opponent  score_team  score_opponent  win\n0     2002       49ers     Giants          16              13  1.0\n1     2002        Jets      Bills          37              31  1.0\n2     2002     Vikings      Bears          23              27  0.0\n3     2002    Chargers    Bengals          34               6  1.0\n4     2002      Chiefs     Browns          40              39  1.0\n...    ...         ...        ...         ...             ...  ...\n5623  2022      Eagles     Giants          22              16  1.0\n5624  2022       49ers  Cardinals          38              13  1.0\n5625  2022    Seahawks       Rams          19              16  1.0\n5626  2022  Commanders    Cowboys          26               6  1.0\n5627  2022     Packers      Lions          16              20  0.0\n\n[10824 rows x 6 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>score_team</th>\n      <th>score_opponent</th>\n      <th>win</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>16</td>\n      <td>13</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2002</td>\n      <td>Jets</td>\n      <td>Bills</td>\n      <td>37</td>\n      <td>31</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2002</td>\n      <td>Vikings</td>\n      <td>Bears</td>\n      <td>23</td>\n      <td>27</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2002</td>\n      <td>Chargers</td>\n      <td>Bengals</td>\n      <td>34</td>\n      <td>6</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2002</td>\n      <td>Chiefs</td>\n      <td>Browns</td>\n      <td>40</td>\n      <td>39</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5623</th>\n      <td>2022</td>\n      <td>Eagles</td>\n      <td>Giants</td>\n      <td>22</td>\n      <td>16</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5624</th>\n      <td>2022</td>\n      <td>49ers</td>\n      <td>Cardinals</td>\n      <td>38</td>\n      <td>13</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5625</th>\n      <td>2022</td>\n      <td>Seahawks</td>\n      <td>Rams</td>\n      <td>19</td>\n      <td>16</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5626</th>\n      <td>2022</td>\n      <td>Commanders</td>\n      <td>Cowboys</td>\n      <td>26</td>\n      <td>6</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5627</th>\n      <td>2022</td>\n      <td>Packers</td>\n      <td>Lions</td>\n      <td>16</td>\n      <td>20</td>\n      <td>0.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>10824 rows × 6 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 27,
      "metadata": {
        "gather": {
          "logged": 1704761790614
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.sort_values(by = [\"date\", \"team\"])"
      ],
      "outputs": [],
      "execution_count": 28,
      "metadata": {
        "gather": {
          "logged": 1704761790828
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 29,
          "data": {
            "text/plain": "      date     team  opponent  score_team  score_opponent  win\n0     2002    49ers    Giants          16              13  1.0\n87    2002    49ers  Seahawks          28              21  1.0\n93    2002    49ers    Saints          27              35  0.0\n125   2002    49ers   Raiders          23              20  1.0\n153   2002    49ers  Chargers          17              20  0.0\n...    ...      ...       ...         ...             ...  ...\n5517  2022  Vikings   Cowboys           3              40  0.0\n5523  2022  Vikings  Patriots          33              26  1.0\n5541  2022  Vikings      Jets          27              22  1.0\n5566  2022  Vikings     Colts          39              36  1.0\n5585  2022  Vikings    Giants          27              24  1.0\n\n[10824 rows x 6 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>score_team</th>\n      <th>score_opponent</th>\n      <th>win</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>16</td>\n      <td>13</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>87</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Seahawks</td>\n      <td>28</td>\n      <td>21</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>93</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Saints</td>\n      <td>27</td>\n      <td>35</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>125</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Raiders</td>\n      <td>23</td>\n      <td>20</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>153</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Chargers</td>\n      <td>17</td>\n      <td>20</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5517</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Cowboys</td>\n      <td>3</td>\n      <td>40</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>5523</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Patriots</td>\n      <td>33</td>\n      <td>26</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5541</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Jets</td>\n      <td>27</td>\n      <td>22</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5566</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Colts</td>\n      <td>39</td>\n      <td>36</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5585</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Giants</td>\n      <td>27</td>\n      <td>24</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>10824 rows × 6 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 29,
      "metadata": {
        "gather": {
          "logged": 1704761791055
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.drop([\"score_opponent\", \"score_team\"], axis = 1)"
      ],
      "outputs": [],
      "execution_count": 30,
      "metadata": {
        "gather": {
          "logged": 1704761791269
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 31,
          "data": {
            "text/plain": "      date     team  opponent  win\n0     2002    49ers    Giants  1.0\n87    2002    49ers  Seahawks  1.0\n93    2002    49ers    Saints  0.0\n125   2002    49ers   Raiders  1.0\n153   2002    49ers  Chargers  0.0\n...    ...      ...       ...  ...\n5517  2022  Vikings   Cowboys  0.0\n5523  2022  Vikings  Patriots  1.0\n5541  2022  Vikings      Jets  1.0\n5566  2022  Vikings     Colts  1.0\n5585  2022  Vikings    Giants  1.0\n\n[10824 rows x 4 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>win</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>87</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Seahawks</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>93</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Saints</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>125</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Raiders</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>153</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Chargers</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5517</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Cowboys</td>\n      <td>0.0</td>\n    </tr>\n    <tr>\n      <th>5523</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Patriots</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5541</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Jets</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5566</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Colts</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>5585</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Giants</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>10824 rows × 4 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 31,
      "metadata": {
        "gather": {
          "logged": 1704761791496
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "team_wins = win_loss[[\"date\", \"team\",\"win\"]].groupby([\"date\", \"team\"]).sum()\n"
      ],
      "outputs": [],
      "execution_count": 32,
      "metadata": {
        "gather": {
          "logged": 1704761791714
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "team_wins = team_wins.transpose()"
      ],
      "outputs": [],
      "execution_count": 33,
      "metadata": {
        "gather": {
          "logged": 1704761791917
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "team_wins"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 34,
          "data": {
            "text/plain": "date  2002                                                                   \\\nteam 49ers Bears Bengals Bills Broncos Browns Buccaneers Cardinals Chargers   \nwin   11.0   4.0     2.0   8.0     9.0    9.0       12.0       5.0      8.0   \n\ndate         ...     2022                                                      \\\nteam Chiefs  ... Patriots Raiders Rams Ravens Saints Seahawks Steelers Texans   \nwin     8.0  ...      8.0     6.0  5.0   10.0    7.0      9.0      9.0    3.0   \n\ndate                 \nteam Titans Vikings  \nwin     7.0    13.0  \n\n[1 rows x 672 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead tr th {\n        text-align: left;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr>\n      <th>date</th>\n      <th colspan=\"10\" halign=\"left\">2002</th>\n      <th>...</th>\n      <th colspan=\"10\" halign=\"left\">2022</th>\n    </tr>\n    <tr>\n      <th>team</th>\n      <th>49ers</th>\n      <th>Bears</th>\n      <th>Bengals</th>\n      <th>Bills</th>\n      <th>Broncos</th>\n      <th>Browns</th>\n      <th>Buccaneers</th>\n      <th>Cardinals</th>\n      <th>Chargers</th>\n      <th>Chiefs</th>\n      <th>...</th>\n      <th>Patriots</th>\n      <th>Raiders</th>\n      <th>Rams</th>\n      <th>Ravens</th>\n      <th>Saints</th>\n      <th>Seahawks</th>\n      <th>Steelers</th>\n      <th>Texans</th>\n      <th>Titans</th>\n      <th>Vikings</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>win</th>\n      <td>11.0</td>\n      <td>4.0</td>\n      <td>2.0</td>\n      <td>8.0</td>\n      <td>9.0</td>\n      <td>9.0</td>\n      <td>12.0</td>\n      <td>5.0</td>\n      <td>8.0</td>\n      <td>8.0</td>\n      <td>...</td>\n      <td>8.0</td>\n      <td>6.0</td>\n      <td>5.0</td>\n      <td>10.0</td>\n      <td>7.0</td>\n      <td>9.0</td>\n      <td>9.0</td>\n      <td>3.0</td>\n      <td>7.0</td>\n      <td>13.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>1 rows × 672 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 34,
      "metadata": {
        "gather": {
          "logged": 1704761792154
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = generate_opponent_wins(win_loss, \"date\", \"opponent\", team_wins)"
      ],
      "outputs": [],
      "execution_count": 35,
      "metadata": {
        "gather": {
          "logged": 1704761799826
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 36,
          "data": {
            "text/plain": "      date     team  opponent  win  opponent wins\n0     2002    49ers    Giants  1.0           10.0\n87    2002    49ers  Seahawks  1.0            7.0\n93    2002    49ers    Saints  0.0            9.0\n125   2002    49ers   Raiders  1.0           11.0\n153   2002    49ers  Chargers  0.0            8.0\n...    ...      ...       ...  ...            ...\n5517  2022  Vikings   Cowboys  0.0           12.0\n5523  2022  Vikings  Patriots  1.0            8.0\n5541  2022  Vikings      Jets  1.0            7.0\n5566  2022  Vikings     Colts  1.0            4.0\n5585  2022  Vikings    Giants  1.0            9.0\n\n[10824 rows x 5 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>opponent</th>\n      <th>win</th>\n      <th>opponent wins</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Giants</td>\n      <td>1.0</td>\n      <td>10.0</td>\n    </tr>\n    <tr>\n      <th>87</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Seahawks</td>\n      <td>1.0</td>\n      <td>7.0</td>\n    </tr>\n    <tr>\n      <th>93</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Saints</td>\n      <td>0.0</td>\n      <td>9.0</td>\n    </tr>\n    <tr>\n      <th>125</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Raiders</td>\n      <td>1.0</td>\n      <td>11.0</td>\n    </tr>\n    <tr>\n      <th>153</th>\n      <td>2002</td>\n      <td>49ers</td>\n      <td>Chargers</td>\n      <td>0.0</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>5517</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Cowboys</td>\n      <td>0.0</td>\n      <td>12.0</td>\n    </tr>\n    <tr>\n      <th>5523</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Patriots</td>\n      <td>1.0</td>\n      <td>8.0</td>\n    </tr>\n    <tr>\n      <th>5541</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Jets</td>\n      <td>1.0</td>\n      <td>7.0</td>\n    </tr>\n    <tr>\n      <th>5566</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Colts</td>\n      <td>1.0</td>\n      <td>4.0</td>\n    </tr>\n    <tr>\n      <th>5585</th>\n      <td>2022</td>\n      <td>Vikings</td>\n      <td>Giants</td>\n      <td>1.0</td>\n      <td>9.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>10824 rows × 5 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 36,
      "metadata": {
        "gather": {
          "logged": 1704761800164
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.drop([\"opponent\", \"win\"], axis = 1)\n",
        "win_loss = win_loss.groupby([\"date\", \"team\"]).mean()\n",
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 37,
          "data": {
            "text/plain": "               opponent wins\ndate team                   \n2002 49ers          8.176471\n     Bears          8.437500\n     Bengals        8.687500\n     Bills          7.687500\n     Broncos        8.562500\n...                      ...\n2022 Seahawks       7.823529\n     Steelers       8.705882\n     Texans         8.058824\n     Titans         8.411765\n     Vikings        7.941176\n\n[672 rows x 1 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>opponent wins</th>\n    </tr>\n    <tr>\n      <th>date</th>\n      <th>team</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2002</th>\n      <th>49ers</th>\n      <td>8.176471</td>\n    </tr>\n    <tr>\n      <th>Bears</th>\n      <td>8.437500</td>\n    </tr>\n    <tr>\n      <th>Bengals</th>\n      <td>8.687500</td>\n    </tr>\n    <tr>\n      <th>Bills</th>\n      <td>7.687500</td>\n    </tr>\n    <tr>\n      <th>Broncos</th>\n      <td>8.562500</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2022</th>\n      <th>Seahawks</th>\n      <td>7.823529</td>\n    </tr>\n    <tr>\n      <th>Steelers</th>\n      <td>8.705882</td>\n    </tr>\n    <tr>\n      <th>Texans</th>\n      <td>8.058824</td>\n    </tr>\n    <tr>\n      <th>Titans</th>\n      <td>8.411765</td>\n    </tr>\n    <tr>\n      <th>Vikings</th>\n      <td>7.941176</td>\n    </tr>\n  </tbody>\n</table>\n<p>672 rows × 1 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 37,
      "metadata": {
        "gather": {
          "logged": 1704761800505
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.reset_index()"
      ],
      "outputs": [],
      "execution_count": 38,
      "metadata": {
        "gather": {
          "logged": 1704761800745
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.rename({\"opponent wins\" : \"avg opp wins\"}, axis = 1)"
      ],
      "outputs": [],
      "execution_count": 39,
      "metadata": {
        "gather": {
          "logged": 1704761800958
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.replace(team_map)\n",
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 40,
          "data": {
            "text/plain": "     date                 team  avg opp wins\n0    2002  San Francisco 49ers      8.176471\n1    2002        Chicago Bears      8.437500\n2    2002   Cincinnati Bengals      8.687500\n3    2002        Buffalo Bills      7.687500\n4    2002       Denver Broncos      8.562500\n..    ...                  ...           ...\n667  2022     Seattle Seahawks      7.823529\n668  2022  Pittsburgh Steelers      8.705882\n669  2022       Houston Texans      8.058824\n670  2022     Tennessee Titans      8.411765\n671  2022    Minnesota Vikings      7.941176\n\n[672 rows x 3 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>date</th>\n      <th>team</th>\n      <th>avg opp wins</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2002</td>\n      <td>San Francisco 49ers</td>\n      <td>8.176471</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2002</td>\n      <td>Chicago Bears</td>\n      <td>8.437500</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2002</td>\n      <td>Cincinnati Bengals</td>\n      <td>8.687500</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2002</td>\n      <td>Buffalo Bills</td>\n      <td>7.687500</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2002</td>\n      <td>Denver Broncos</td>\n      <td>8.562500</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>667</th>\n      <td>2022</td>\n      <td>Seattle Seahawks</td>\n      <td>7.823529</td>\n    </tr>\n    <tr>\n      <th>668</th>\n      <td>2022</td>\n      <td>Pittsburgh Steelers</td>\n      <td>8.705882</td>\n    </tr>\n    <tr>\n      <th>669</th>\n      <td>2022</td>\n      <td>Houston Texans</td>\n      <td>8.058824</td>\n    </tr>\n    <tr>\n      <th>670</th>\n      <td>2022</td>\n      <td>Tennessee Titans</td>\n      <td>8.411765</td>\n    </tr>\n    <tr>\n      <th>671</th>\n      <td>2022</td>\n      <td>Minnesota Vikings</td>\n      <td>7.941176</td>\n    </tr>\n  </tbody>\n</table>\n<p>672 rows × 3 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 40,
      "metadata": {
        "gather": {
          "logged": 1704761801232
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "win_loss = win_loss.rename({\"date\": \"Year\", \"team\": \"Team\"}, axis =1)\n",
        "win_loss = win_loss[~win_loss[\"Year\"].isin([2002, 2003])]\n",
        "win_loss = win_loss.set_index([\"Year\", \"Team\"])\n",
        "win_loss"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 41,
          "data": {
            "text/plain": "                          avg opp wins\nYear Team                             \n2004 San Francisco 49ers      7.812500\n     Chicago Bears            7.437500\n     Cincinnati Bengals       8.687500\n     Buffalo Bills            8.187500\n     Denver Broncos           7.750000\n...                                ...\n2022 Seattle Seahawks         7.823529\n     Pittsburgh Steelers      8.705882\n     Houston Texans           8.058824\n     Tennessee Titans         8.411765\n     Minnesota Vikings        7.941176\n\n[608 rows x 1 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>avg opp wins</th>\n    </tr>\n    <tr>\n      <th>Year</th>\n      <th>Team</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2004</th>\n      <th>San Francisco 49ers</th>\n      <td>7.812500</td>\n    </tr>\n    <tr>\n      <th>Chicago Bears</th>\n      <td>7.437500</td>\n    </tr>\n    <tr>\n      <th>Cincinnati Bengals</th>\n      <td>8.687500</td>\n    </tr>\n    <tr>\n      <th>Buffalo Bills</th>\n      <td>8.187500</td>\n    </tr>\n    <tr>\n      <th>Denver Broncos</th>\n      <td>7.750000</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2022</th>\n      <th>Seattle Seahawks</th>\n      <td>7.823529</td>\n    </tr>\n    <tr>\n      <th>Pittsburgh Steelers</th>\n      <td>8.705882</td>\n    </tr>\n    <tr>\n      <th>Houston Texans</th>\n      <td>8.058824</td>\n    </tr>\n    <tr>\n      <th>Tennessee Titans</th>\n      <td>8.411765</td>\n    </tr>\n    <tr>\n      <th>Minnesota Vikings</th>\n      <td>7.941176</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 1 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 41,
      "metadata": {
        "gather": {
          "logged": 1704761801567
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = stats.reset_index()"
      ],
      "outputs": [],
      "execution_count": 42,
      "metadata": {
        "gather": {
          "logged": 1704761801819
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = stats.sort_values([\"Year\", \"Team\"])\n",
        "stats = stats.replace({\"Baltimore Ravens \":\"Baltimore Ravens\"})\n"
      ],
      "outputs": [],
      "execution_count": 43,
      "metadata": {
        "gather": {
          "logged": 1704761802081
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = stats.set_index([\"Year\", \"Team\"])"
      ],
      "outputs": [],
      "execution_count": 44,
      "metadata": {
        "gather": {
          "logged": 1704761802323
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 45,
          "data": {
            "text/plain": "                            Wins  Losses  Ties  Passing_Attempts  \\\nYear Team                                                          \n2004 Arizona Cardinals         6      10     0               533   \n     Atlanta Falcons          11       5     0               395   \n     Baltimore Ravens          9       7     0               465   \n     Buffalo Bills             9       7     0               461   \n     Carolina Panthers         7       9     0               536   \n...                          ...     ...   ...               ...   \n2022 San Francisco 49ers      13       4     0               512   \n     Seattle Seahawks          9       8     0               573   \n     Tampa Bay Buccaneers      8       9     0               751   \n     Tennessee Titans          7      10     0               456   \n     Washington Commanders     8       8     1               554   \n\n                            Passing_Completions  Passing_Yards  Passing_TDs  \\\nYear Team                                                                     \n2004 Arizona Cardinals                      299           3202           14   \n     Atlanta Falcons                        217           2692           15   \n     Baltimore Ravens                       258           2559           13   \n     Buffalo Bills                          262           3032           21   \n     Carolina Panthers                      311           3889           29   \n...                                         ...            ...          ...   \n2022 San Francisco 49ers                    338           4409           30   \n     Seattle Seahawks                       399           4282           30   \n     Tampa Bay Buccaneers                   499           4746           26   \n     Tennessee Titans                       285           3227           16   \n     Washington Commanders                  344           3783           24   \n\n                            Interceptions_Thrown  Rushing _Attempts  \\\nYear Team                                                             \n2004 Arizona Cardinals                        18                475   \n     Atlanta Falcons                          16                524   \n     Baltimore Ravens                         11                491   \n     Buffalo Bills                            17                483   \n     Carolina Panthers                        15                422   \n...                                          ...                ...   \n2022 San Francisco 49ers                       9                504   \n     Seattle Seahawks                         12                425   \n     Tampa Bay Buccaneers                     10                386   \n     Tennessee Titans                         11                487   \n     Washington Commanders                    16                538   \n\n                            Rushing_Yards  ...  Assisted_Tackles  Sacks  \\\nYear Team                                  ...                            \n2004 Arizona Cardinals               1668  ...               197     38   \n     Atlanta Falcons                 2672  ...               147     48   \n     Baltimore Ravens                2063  ...               268     39   \n     Buffalo Bills                   1874  ...               377     45   \n     Carolina Panthers               1582  ...               196     34   \n...                                   ...  ...               ...    ...   \n2022 San Francisco 49ers             2360  ...               439     44   \n     Seattle Seahawks                2042  ...               417     45   \n     Tampa Bay Buccaneers            1308  ...               413     44   \n     Tennessee Titans                2131  ...               419     39   \n     Washington Commanders           2143  ...               428     43   \n\n                            Tackles_For_Loss  Pass_Deflections  Interceptions  \\\nYear Team                                                                       \n2004 Arizona Cardinals                   0.0               234             15   \n     Atlanta Falcons                     0.0               189             19   \n     Baltimore Ravens                    0.0               225             21   \n     Buffalo Bills                       0.0               225             24   \n     Carolina Panthers                   0.0               210             26   \n...                                      ...               ...            ...   \n2022 San Francisco 49ers                77.0                78             20   \n     Seattle Seahawks                   75.0                81             14   \n     Tampa Bay Buccaneers               89.0                59             10   \n     Tennessee Titans                   76.0                78             14   \n     Washington Commanders              89.0                68              9   \n\n                            Interception_TDs  Forced_Fumbles  \\\nYear Team                                                      \n2004 Arizona Cardinals                     1              20   \n     Atlanta Falcons                       4              19   \n     Baltimore Ravens                      5              17   \n     Buffalo Bills                         4              21   \n     Carolina Panthers                     2              19   \n...                                      ...             ...   \n2022 San Francisco 49ers                   2              19   \n     Seattle Seahawks                      1              21   \n     Tampa Bay Buccaneers                  1              12   \n     Tennessee Titans                      1              11   \n     Washington Commanders                 2               9   \n\n                            Fumbles_Recovered  Fumble__TDs  Kicks_Blocked  \nYear Team                                                                  \n2004 Arizona Cardinals                      0            1              2  \n     Atlanta Falcons                        0            1              2  \n     Baltimore Ravens                       0            2              0  \n     Buffalo Bills                          0            0              1  \n     Carolina Panthers                      0            1              2  \n...                                       ...          ...            ...  \n2022 San Francisco 49ers                   10            1              0  \n     Seattle Seahawks                      11            0              1  \n     Tampa Bay Buccaneers                  10            0              1  \n     Tennessee Titans                       6            1              1  \n     Washington Commanders                  9            1              1  \n\n[608 rows x 34 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>Wins</th>\n      <th>Losses</th>\n      <th>Ties</th>\n      <th>Passing_Attempts</th>\n      <th>Passing_Completions</th>\n      <th>Passing_Yards</th>\n      <th>Passing_TDs</th>\n      <th>Interceptions_Thrown</th>\n      <th>Rushing _Attempts</th>\n      <th>Rushing_Yards</th>\n      <th>...</th>\n      <th>Assisted_Tackles</th>\n      <th>Sacks</th>\n      <th>Tackles_For_Loss</th>\n      <th>Pass_Deflections</th>\n      <th>Interceptions</th>\n      <th>Interception_TDs</th>\n      <th>Forced_Fumbles</th>\n      <th>Fumbles_Recovered</th>\n      <th>Fumble__TDs</th>\n      <th>Kicks_Blocked</th>\n    </tr>\n    <tr>\n      <th>Year</th>\n      <th>Team</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2004</th>\n      <th>Arizona Cardinals</th>\n      <td>6</td>\n      <td>10</td>\n      <td>0</td>\n      <td>533</td>\n      <td>299</td>\n      <td>3202</td>\n      <td>14</td>\n      <td>18</td>\n      <td>475</td>\n      <td>1668</td>\n      <td>...</td>\n      <td>197</td>\n      <td>38</td>\n      <td>0.0</td>\n      <td>234</td>\n      <td>15</td>\n      <td>1</td>\n      <td>20</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>Atlanta Falcons</th>\n      <td>11</td>\n      <td>5</td>\n      <td>0</td>\n      <td>395</td>\n      <td>217</td>\n      <td>2692</td>\n      <td>15</td>\n      <td>16</td>\n      <td>524</td>\n      <td>2672</td>\n      <td>...</td>\n      <td>147</td>\n      <td>48</td>\n      <td>0.0</td>\n      <td>189</td>\n      <td>19</td>\n      <td>4</td>\n      <td>19</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>Baltimore Ravens</th>\n      <td>9</td>\n      <td>7</td>\n      <td>0</td>\n      <td>465</td>\n      <td>258</td>\n      <td>2559</td>\n      <td>13</td>\n      <td>11</td>\n      <td>491</td>\n      <td>2063</td>\n      <td>...</td>\n      <td>268</td>\n      <td>39</td>\n      <td>0.0</td>\n      <td>225</td>\n      <td>21</td>\n      <td>5</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Buffalo Bills</th>\n      <td>9</td>\n      <td>7</td>\n      <td>0</td>\n      <td>461</td>\n      <td>262</td>\n      <td>3032</td>\n      <td>21</td>\n      <td>17</td>\n      <td>483</td>\n      <td>1874</td>\n      <td>...</td>\n      <td>377</td>\n      <td>45</td>\n      <td>0.0</td>\n      <td>225</td>\n      <td>24</td>\n      <td>4</td>\n      <td>21</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>Carolina Panthers</th>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>536</td>\n      <td>311</td>\n      <td>3889</td>\n      <td>29</td>\n      <td>15</td>\n      <td>422</td>\n      <td>1582</td>\n      <td>...</td>\n      <td>196</td>\n      <td>34</td>\n      <td>0.0</td>\n      <td>210</td>\n      <td>26</td>\n      <td>2</td>\n      <td>19</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2022</th>\n      <th>San Francisco 49ers</th>\n      <td>13</td>\n      <td>4</td>\n      <td>0</td>\n      <td>512</td>\n      <td>338</td>\n      <td>4409</td>\n      <td>30</td>\n      <td>9</td>\n      <td>504</td>\n      <td>2360</td>\n      <td>...</td>\n      <td>439</td>\n      <td>44</td>\n      <td>77.0</td>\n      <td>78</td>\n      <td>20</td>\n      <td>2</td>\n      <td>19</td>\n      <td>10</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Seattle Seahawks</th>\n      <td>9</td>\n      <td>8</td>\n      <td>0</td>\n      <td>573</td>\n      <td>399</td>\n      <td>4282</td>\n      <td>30</td>\n      <td>12</td>\n      <td>425</td>\n      <td>2042</td>\n      <td>...</td>\n      <td>417</td>\n      <td>45</td>\n      <td>75.0</td>\n      <td>81</td>\n      <td>14</td>\n      <td>1</td>\n      <td>21</td>\n      <td>11</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>Tampa Bay Buccaneers</th>\n      <td>8</td>\n      <td>9</td>\n      <td>0</td>\n      <td>751</td>\n      <td>499</td>\n      <td>4746</td>\n      <td>26</td>\n      <td>10</td>\n      <td>386</td>\n      <td>1308</td>\n      <td>...</td>\n      <td>413</td>\n      <td>44</td>\n      <td>89.0</td>\n      <td>59</td>\n      <td>10</td>\n      <td>1</td>\n      <td>12</td>\n      <td>10</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>Tennessee Titans</th>\n      <td>7</td>\n      <td>10</td>\n      <td>0</td>\n      <td>456</td>\n      <td>285</td>\n      <td>3227</td>\n      <td>16</td>\n      <td>11</td>\n      <td>487</td>\n      <td>2131</td>\n      <td>...</td>\n      <td>419</td>\n      <td>39</td>\n      <td>76.0</td>\n      <td>78</td>\n      <td>14</td>\n      <td>1</td>\n      <td>11</td>\n      <td>6</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>Washington Commanders</th>\n      <td>8</td>\n      <td>8</td>\n      <td>1</td>\n      <td>554</td>\n      <td>344</td>\n      <td>3783</td>\n      <td>24</td>\n      <td>16</td>\n      <td>538</td>\n      <td>2143</td>\n      <td>...</td>\n      <td>428</td>\n      <td>43</td>\n      <td>89.0</td>\n      <td>68</td>\n      <td>9</td>\n      <td>2</td>\n      <td>9</td>\n      <td>9</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 34 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 45,
      "metadata": {
        "gather": {
          "logged": 1704761802612
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = pd.concat([stats, win_loss], axis = 1)\n",
        "stats"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 46,
          "data": {
            "text/plain": "                            Wins  Losses  Ties  Passing_Attempts  \\\nYear Team                                                          \n2004 Arizona Cardinals         6      10     0               533   \n     Atlanta Falcons          11       5     0               395   \n     Baltimore Ravens          9       7     0               465   \n     Buffalo Bills             9       7     0               461   \n     Carolina Panthers         7       9     0               536   \n...                          ...     ...   ...               ...   \n2022 San Francisco 49ers      13       4     0               512   \n     Seattle Seahawks          9       8     0               573   \n     Tampa Bay Buccaneers      8       9     0               751   \n     Tennessee Titans          7      10     0               456   \n     Washington Commanders     8       8     1               554   \n\n                            Passing_Completions  Passing_Yards  Passing_TDs  \\\nYear Team                                                                     \n2004 Arizona Cardinals                      299           3202           14   \n     Atlanta Falcons                        217           2692           15   \n     Baltimore Ravens                       258           2559           13   \n     Buffalo Bills                          262           3032           21   \n     Carolina Panthers                      311           3889           29   \n...                                         ...            ...          ...   \n2022 San Francisco 49ers                    338           4409           30   \n     Seattle Seahawks                       399           4282           30   \n     Tampa Bay Buccaneers                   499           4746           26   \n     Tennessee Titans                       285           3227           16   \n     Washington Commanders                  344           3783           24   \n\n                            Interceptions_Thrown  Rushing _Attempts  \\\nYear Team                                                             \n2004 Arizona Cardinals                        18                475   \n     Atlanta Falcons                          16                524   \n     Baltimore Ravens                         11                491   \n     Buffalo Bills                            17                483   \n     Carolina Panthers                        15                422   \n...                                          ...                ...   \n2022 San Francisco 49ers                       9                504   \n     Seattle Seahawks                         12                425   \n     Tampa Bay Buccaneers                     10                386   \n     Tennessee Titans                         11                487   \n     Washington Commanders                    16                538   \n\n                            Rushing_Yards  ...  Sacks  Tackles_For_Loss  \\\nYear Team                                  ...                            \n2004 Arizona Cardinals               1668  ...     38               0.0   \n     Atlanta Falcons                 2672  ...     48               0.0   \n     Baltimore Ravens                2063  ...     39               0.0   \n     Buffalo Bills                   1874  ...     45               0.0   \n     Carolina Panthers               1582  ...     34               0.0   \n...                                   ...  ...    ...               ...   \n2022 San Francisco 49ers             2360  ...     44              77.0   \n     Seattle Seahawks                2042  ...     45              75.0   \n     Tampa Bay Buccaneers            1308  ...     44              89.0   \n     Tennessee Titans                2131  ...     39              76.0   \n     Washington Commanders           2143  ...     43              89.0   \n\n                            Pass_Deflections  Interceptions  Interception_TDs  \\\nYear Team                                                                       \n2004 Arizona Cardinals                   234             15                 1   \n     Atlanta Falcons                     189             19                 4   \n     Baltimore Ravens                    225             21                 5   \n     Buffalo Bills                       225             24                 4   \n     Carolina Panthers                   210             26                 2   \n...                                      ...            ...               ...   \n2022 San Francisco 49ers                  78             20                 2   \n     Seattle Seahawks                     81             14                 1   \n     Tampa Bay Buccaneers                 59             10                 1   \n     Tennessee Titans                     78             14                 1   \n     Washington Commanders                68              9                 2   \n\n                            Forced_Fumbles  Fumbles_Recovered  Fumble__TDs  \\\nYear Team                                                                    \n2004 Arizona Cardinals                  20                  0            1   \n     Atlanta Falcons                    19                  0            1   \n     Baltimore Ravens                   17                  0            2   \n     Buffalo Bills                      21                  0            0   \n     Carolina Panthers                  19                  0            1   \n...                                    ...                ...          ...   \n2022 San Francisco 49ers                19                 10            1   \n     Seattle Seahawks                   21                 11            0   \n     Tampa Bay Buccaneers               12                 10            0   \n     Tennessee Titans                   11                  6            1   \n     Washington Commanders               9                  9            1   \n\n                            Kicks_Blocked  avg opp wins  \nYear Team                                                \n2004 Arizona Cardinals                  2      7.375000  \n     Atlanta Falcons                    2      6.937500  \n     Baltimore Ravens                   0      8.812500  \n     Buffalo Bills                      1      8.187500  \n     Carolina Panthers                  2      8.125000  \n...                                   ...           ...  \n2022 San Francisco 49ers                0      7.058824  \n     Seattle Seahawks                   1      7.823529  \n     Tampa Bay Buccaneers               1      8.529412  \n     Tennessee Titans                   1      8.411765  \n     Washington Commanders              1      9.000000  \n\n[608 rows x 35 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>Wins</th>\n      <th>Losses</th>\n      <th>Ties</th>\n      <th>Passing_Attempts</th>\n      <th>Passing_Completions</th>\n      <th>Passing_Yards</th>\n      <th>Passing_TDs</th>\n      <th>Interceptions_Thrown</th>\n      <th>Rushing _Attempts</th>\n      <th>Rushing_Yards</th>\n      <th>...</th>\n      <th>Sacks</th>\n      <th>Tackles_For_Loss</th>\n      <th>Pass_Deflections</th>\n      <th>Interceptions</th>\n      <th>Interception_TDs</th>\n      <th>Forced_Fumbles</th>\n      <th>Fumbles_Recovered</th>\n      <th>Fumble__TDs</th>\n      <th>Kicks_Blocked</th>\n      <th>avg opp wins</th>\n    </tr>\n    <tr>\n      <th>Year</th>\n      <th>Team</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2004</th>\n      <th>Arizona Cardinals</th>\n      <td>6</td>\n      <td>10</td>\n      <td>0</td>\n      <td>533</td>\n      <td>299</td>\n      <td>3202</td>\n      <td>14</td>\n      <td>18</td>\n      <td>475</td>\n      <td>1668</td>\n      <td>...</td>\n      <td>38</td>\n      <td>0.0</td>\n      <td>234</td>\n      <td>15</td>\n      <td>1</td>\n      <td>20</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>7.375000</td>\n    </tr>\n    <tr>\n      <th>Atlanta Falcons</th>\n      <td>11</td>\n      <td>5</td>\n      <td>0</td>\n      <td>395</td>\n      <td>217</td>\n      <td>2692</td>\n      <td>15</td>\n      <td>16</td>\n      <td>524</td>\n      <td>2672</td>\n      <td>...</td>\n      <td>48</td>\n      <td>0.0</td>\n      <td>189</td>\n      <td>19</td>\n      <td>4</td>\n      <td>19</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>6.937500</td>\n    </tr>\n    <tr>\n      <th>Baltimore Ravens</th>\n      <td>9</td>\n      <td>7</td>\n      <td>0</td>\n      <td>465</td>\n      <td>258</td>\n      <td>2559</td>\n      <td>13</td>\n      <td>11</td>\n      <td>491</td>\n      <td>2063</td>\n      <td>...</td>\n      <td>39</td>\n      <td>0.0</td>\n      <td>225</td>\n      <td>21</td>\n      <td>5</td>\n      <td>17</td>\n      <td>0</td>\n      <td>2</td>\n      <td>0</td>\n      <td>8.812500</td>\n    </tr>\n    <tr>\n      <th>Buffalo Bills</th>\n      <td>9</td>\n      <td>7</td>\n      <td>0</td>\n      <td>461</td>\n      <td>262</td>\n      <td>3032</td>\n      <td>21</td>\n      <td>17</td>\n      <td>483</td>\n      <td>1874</td>\n      <td>...</td>\n      <td>45</td>\n      <td>0.0</td>\n      <td>225</td>\n      <td>24</td>\n      <td>4</td>\n      <td>21</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>8.187500</td>\n    </tr>\n    <tr>\n      <th>Carolina Panthers</th>\n      <td>7</td>\n      <td>9</td>\n      <td>0</td>\n      <td>536</td>\n      <td>311</td>\n      <td>3889</td>\n      <td>29</td>\n      <td>15</td>\n      <td>422</td>\n      <td>1582</td>\n      <td>...</td>\n      <td>34</td>\n      <td>0.0</td>\n      <td>210</td>\n      <td>26</td>\n      <td>2</td>\n      <td>19</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>8.125000</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2022</th>\n      <th>San Francisco 49ers</th>\n      <td>13</td>\n      <td>4</td>\n      <td>0</td>\n      <td>512</td>\n      <td>338</td>\n      <td>4409</td>\n      <td>30</td>\n      <td>9</td>\n      <td>504</td>\n      <td>2360</td>\n      <td>...</td>\n      <td>44</td>\n      <td>77.0</td>\n      <td>78</td>\n      <td>20</td>\n      <td>2</td>\n      <td>19</td>\n      <td>10</td>\n      <td>1</td>\n      <td>0</td>\n      <td>7.058824</td>\n    </tr>\n    <tr>\n      <th>Seattle Seahawks</th>\n      <td>9</td>\n      <td>8</td>\n      <td>0</td>\n      <td>573</td>\n      <td>399</td>\n      <td>4282</td>\n      <td>30</td>\n      <td>12</td>\n      <td>425</td>\n      <td>2042</td>\n      <td>...</td>\n      <td>45</td>\n      <td>75.0</td>\n      <td>81</td>\n      <td>14</td>\n      <td>1</td>\n      <td>21</td>\n      <td>11</td>\n      <td>0</td>\n      <td>1</td>\n      <td>7.823529</td>\n    </tr>\n    <tr>\n      <th>Tampa Bay Buccaneers</th>\n      <td>8</td>\n      <td>9</td>\n      <td>0</td>\n      <td>751</td>\n      <td>499</td>\n      <td>4746</td>\n      <td>26</td>\n      <td>10</td>\n      <td>386</td>\n      <td>1308</td>\n      <td>...</td>\n      <td>44</td>\n      <td>89.0</td>\n      <td>59</td>\n      <td>10</td>\n      <td>1</td>\n      <td>12</td>\n      <td>10</td>\n      <td>0</td>\n      <td>1</td>\n      <td>8.529412</td>\n    </tr>\n    <tr>\n      <th>Tennessee Titans</th>\n      <td>7</td>\n      <td>10</td>\n      <td>0</td>\n      <td>456</td>\n      <td>285</td>\n      <td>3227</td>\n      <td>16</td>\n      <td>11</td>\n      <td>487</td>\n      <td>2131</td>\n      <td>...</td>\n      <td>39</td>\n      <td>76.0</td>\n      <td>78</td>\n      <td>14</td>\n      <td>1</td>\n      <td>11</td>\n      <td>6</td>\n      <td>1</td>\n      <td>1</td>\n      <td>8.411765</td>\n    </tr>\n    <tr>\n      <th>Washington Commanders</th>\n      <td>8</td>\n      <td>8</td>\n      <td>1</td>\n      <td>554</td>\n      <td>344</td>\n      <td>3783</td>\n      <td>24</td>\n      <td>16</td>\n      <td>538</td>\n      <td>2143</td>\n      <td>...</td>\n      <td>43</td>\n      <td>89.0</td>\n      <td>68</td>\n      <td>9</td>\n      <td>2</td>\n      <td>9</td>\n      <td>9</td>\n      <td>1</td>\n      <td>1</td>\n      <td>9.000000</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 35 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 46,
      "metadata": {
        "gather": {
          "logged": 1704761802936
        },
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "pre2021 = stats.loc[2004:2020]\n",
        "post2021 = stats.loc[2021:2022]\n",
        "\n",
        "pre2021 = pre2021/16\n",
        "post2021 = post2021/17"
      ],
      "outputs": [],
      "execution_count": 47,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761803216
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = pd.concat([pre2021, post2021])"
      ],
      "outputs": [],
      "execution_count": 48,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761803484
        }
      }
    },
    {
      "cell_type": "code",
      "source": [],
      "outputs": [],
      "execution_count": null,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704756770714
        }
      }
    },
    {
      "cell_type": "code",
      "source": [],
      "outputs": [],
      "execution_count": null,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704756764241
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 49,
          "data": {
            "text/plain": "                                Wins    Losses      Ties  Passing_Attempts  \\\nYear Team                                                                    \n2004 Arizona Cardinals      0.375000  0.625000  0.000000         33.312500   \n     Atlanta Falcons        0.687500  0.312500  0.000000         24.687500   \n     Baltimore Ravens       0.562500  0.437500  0.000000         29.062500   \n     Buffalo Bills          0.562500  0.437500  0.000000         28.812500   \n     Carolina Panthers      0.437500  0.562500  0.000000         33.500000   \n...                              ...       ...       ...               ...   \n2022 San Francisco 49ers    0.764706  0.235294  0.000000         30.117647   \n     Seattle Seahawks       0.529412  0.470588  0.000000         33.705882   \n     Tampa Bay Buccaneers   0.470588  0.529412  0.000000         44.176471   \n     Tennessee Titans       0.411765  0.588235  0.000000         26.823529   \n     Washington Commanders  0.470588  0.470588  0.058824         32.588235   \n\n                            Passing_Completions  Passing_Yards  Passing_TDs  \\\nYear Team                                                                     \n2004 Arizona Cardinals                18.687500     200.125000     0.875000   \n     Atlanta Falcons                  13.562500     168.250000     0.937500   \n     Baltimore Ravens                 16.125000     159.937500     0.812500   \n     Buffalo Bills                    16.375000     189.500000     1.312500   \n     Carolina Panthers                19.437500     243.062500     1.812500   \n...                                         ...            ...          ...   \n2022 San Francisco 49ers              19.882353     259.352941     1.764706   \n     Seattle Seahawks                 23.470588     251.882353     1.764706   \n     Tampa Bay Buccaneers             29.352941     279.176471     1.529412   \n     Tennessee Titans                 16.764706     189.823529     0.941176   \n     Washington Commanders            20.235294     222.529412     1.411765   \n\n                            Interceptions_Thrown  Rushing _Attempts  \\\nYear Team                                                             \n2004 Arizona Cardinals                  1.125000          29.687500   \n     Atlanta Falcons                    1.000000          32.750000   \n     Baltimore Ravens                   0.687500          30.687500   \n     Buffalo Bills                      1.062500          30.187500   \n     Carolina Panthers                  0.937500          26.375000   \n...                                          ...                ...   \n2022 San Francisco 49ers                0.529412          29.647059   \n     Seattle Seahawks                   0.705882          25.000000   \n     Tampa Bay Buccaneers               0.588235          22.705882   \n     Tennessee Titans                   0.647059          28.647059   \n     Washington Commanders              0.941176          31.647059   \n\n                            Rushing_Yards  ...     Sacks  Tackles_For_Loss  \\\nYear Team                                  ...                               \n2004 Arizona Cardinals         104.250000  ...  2.375000          0.000000   \n     Atlanta Falcons           167.000000  ...  3.000000          0.000000   \n     Baltimore Ravens          128.937500  ...  2.437500          0.000000   \n     Buffalo Bills             117.125000  ...  2.812500          0.000000   \n     Carolina Panthers          98.875000  ...  2.125000          0.000000   \n...                                   ...  ...       ...               ...   \n2022 San Francisco 49ers       138.823529  ...  2.588235          4.529412   \n     Seattle Seahawks          120.117647  ...  2.647059          4.411765   \n     Tampa Bay Buccaneers       76.941176  ...  2.588235          5.235294   \n     Tennessee Titans          125.352941  ...  2.294118          4.470588   \n     Washington Commanders     126.058824  ...  2.529412          5.235294   \n\n                            Pass_Deflections  Interceptions  Interception_TDs  \\\nYear Team                                                                       \n2004 Arizona Cardinals             14.625000       0.937500          0.062500   \n     Atlanta Falcons               11.812500       1.187500          0.250000   \n     Baltimore Ravens              14.062500       1.312500          0.312500   \n     Buffalo Bills                 14.062500       1.500000          0.250000   \n     Carolina Panthers             13.125000       1.625000          0.125000   \n...                                      ...            ...               ...   \n2022 San Francisco 49ers            4.588235       1.176471          0.117647   \n     Seattle Seahawks               4.764706       0.823529          0.058824   \n     Tampa Bay Buccaneers           3.470588       0.588235          0.058824   \n     Tennessee Titans               4.588235       0.823529          0.058824   \n     Washington Commanders          4.000000       0.529412          0.117647   \n\n                            Forced_Fumbles  Fumbles_Recovered  Fumble__TDs  \\\nYear Team                                                                    \n2004 Arizona Cardinals            1.250000           0.000000     0.062500   \n     Atlanta Falcons              1.187500           0.000000     0.062500   \n     Baltimore Ravens             1.062500           0.000000     0.125000   \n     Buffalo Bills                1.312500           0.000000     0.000000   \n     Carolina Panthers            1.187500           0.000000     0.062500   \n...                                    ...                ...          ...   \n2022 San Francisco 49ers          1.117647           0.588235     0.058824   \n     Seattle Seahawks             1.235294           0.647059     0.000000   \n     Tampa Bay Buccaneers         0.705882           0.588235     0.000000   \n     Tennessee Titans             0.647059           0.352941     0.058824   \n     Washington Commanders        0.529412           0.529412     0.058824   \n\n                            Kicks_Blocked  avg opp wins  \nYear Team                                                \n2004 Arizona Cardinals           0.125000      0.460938  \n     Atlanta Falcons             0.125000      0.433594  \n     Baltimore Ravens            0.000000      0.550781  \n     Buffalo Bills               0.062500      0.511719  \n     Carolina Panthers           0.125000      0.507812  \n...                                   ...           ...  \n2022 San Francisco 49ers         0.000000      0.415225  \n     Seattle Seahawks            0.058824      0.460208  \n     Tampa Bay Buccaneers        0.058824      0.501730  \n     Tennessee Titans            0.058824      0.494810  \n     Washington Commanders       0.058824      0.529412  \n\n[608 rows x 35 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>Wins</th>\n      <th>Losses</th>\n      <th>Ties</th>\n      <th>Passing_Attempts</th>\n      <th>Passing_Completions</th>\n      <th>Passing_Yards</th>\n      <th>Passing_TDs</th>\n      <th>Interceptions_Thrown</th>\n      <th>Rushing _Attempts</th>\n      <th>Rushing_Yards</th>\n      <th>...</th>\n      <th>Sacks</th>\n      <th>Tackles_For_Loss</th>\n      <th>Pass_Deflections</th>\n      <th>Interceptions</th>\n      <th>Interception_TDs</th>\n      <th>Forced_Fumbles</th>\n      <th>Fumbles_Recovered</th>\n      <th>Fumble__TDs</th>\n      <th>Kicks_Blocked</th>\n      <th>avg opp wins</th>\n    </tr>\n    <tr>\n      <th>Year</th>\n      <th>Team</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2004</th>\n      <th>Arizona Cardinals</th>\n      <td>0.375000</td>\n      <td>0.625000</td>\n      <td>0.000000</td>\n      <td>33.312500</td>\n      <td>18.687500</td>\n      <td>200.125000</td>\n      <td>0.875000</td>\n      <td>1.125000</td>\n      <td>29.687500</td>\n      <td>104.250000</td>\n      <td>...</td>\n      <td>2.375000</td>\n      <td>0.000000</td>\n      <td>14.625000</td>\n      <td>0.937500</td>\n      <td>0.062500</td>\n      <td>1.250000</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.460938</td>\n    </tr>\n    <tr>\n      <th>Atlanta Falcons</th>\n      <td>0.687500</td>\n      <td>0.312500</td>\n      <td>0.000000</td>\n      <td>24.687500</td>\n      <td>13.562500</td>\n      <td>168.250000</td>\n      <td>0.937500</td>\n      <td>1.000000</td>\n      <td>32.750000</td>\n      <td>167.000000</td>\n      <td>...</td>\n      <td>3.000000</td>\n      <td>0.000000</td>\n      <td>11.812500</td>\n      <td>1.187500</td>\n      <td>0.250000</td>\n      <td>1.187500</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.433594</td>\n    </tr>\n    <tr>\n      <th>Baltimore Ravens</th>\n      <td>0.562500</td>\n      <td>0.437500</td>\n      <td>0.000000</td>\n      <td>29.062500</td>\n      <td>16.125000</td>\n      <td>159.937500</td>\n      <td>0.812500</td>\n      <td>0.687500</td>\n      <td>30.687500</td>\n      <td>128.937500</td>\n      <td>...</td>\n      <td>2.437500</td>\n      <td>0.000000</td>\n      <td>14.062500</td>\n      <td>1.312500</td>\n      <td>0.312500</td>\n      <td>1.062500</td>\n      <td>0.000000</td>\n      <td>0.125000</td>\n      <td>0.000000</td>\n      <td>0.550781</td>\n    </tr>\n    <tr>\n      <th>Buffalo Bills</th>\n      <td>0.562500</td>\n      <td>0.437500</td>\n      <td>0.000000</td>\n      <td>28.812500</td>\n      <td>16.375000</td>\n      <td>189.500000</td>\n      <td>1.312500</td>\n      <td>1.062500</td>\n      <td>30.187500</td>\n      <td>117.125000</td>\n      <td>...</td>\n      <td>2.812500</td>\n      <td>0.000000</td>\n      <td>14.062500</td>\n      <td>1.500000</td>\n      <td>0.250000</td>\n      <td>1.312500</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.511719</td>\n    </tr>\n    <tr>\n      <th>Carolina Panthers</th>\n      <td>0.437500</td>\n      <td>0.562500</td>\n      <td>0.000000</td>\n      <td>33.500000</td>\n      <td>19.437500</td>\n      <td>243.062500</td>\n      <td>1.812500</td>\n      <td>0.937500</td>\n      <td>26.375000</td>\n      <td>98.875000</td>\n      <td>...</td>\n      <td>2.125000</td>\n      <td>0.000000</td>\n      <td>13.125000</td>\n      <td>1.625000</td>\n      <td>0.125000</td>\n      <td>1.187500</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.507812</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2022</th>\n      <th>San Francisco 49ers</th>\n      <td>0.764706</td>\n      <td>0.235294</td>\n      <td>0.000000</td>\n      <td>30.117647</td>\n      <td>19.882353</td>\n      <td>259.352941</td>\n      <td>1.764706</td>\n      <td>0.529412</td>\n      <td>29.647059</td>\n      <td>138.823529</td>\n      <td>...</td>\n      <td>2.588235</td>\n      <td>4.529412</td>\n      <td>4.588235</td>\n      <td>1.176471</td>\n      <td>0.117647</td>\n      <td>1.117647</td>\n      <td>0.588235</td>\n      <td>0.058824</td>\n      <td>0.000000</td>\n      <td>0.415225</td>\n    </tr>\n    <tr>\n      <th>Seattle Seahawks</th>\n      <td>0.529412</td>\n      <td>0.470588</td>\n      <td>0.000000</td>\n      <td>33.705882</td>\n      <td>23.470588</td>\n      <td>251.882353</td>\n      <td>1.764706</td>\n      <td>0.705882</td>\n      <td>25.000000</td>\n      <td>120.117647</td>\n      <td>...</td>\n      <td>2.647059</td>\n      <td>4.411765</td>\n      <td>4.764706</td>\n      <td>0.823529</td>\n      <td>0.058824</td>\n      <td>1.235294</td>\n      <td>0.647059</td>\n      <td>0.000000</td>\n      <td>0.058824</td>\n      <td>0.460208</td>\n    </tr>\n    <tr>\n      <th>Tampa Bay Buccaneers</th>\n      <td>0.470588</td>\n      <td>0.529412</td>\n      <td>0.000000</td>\n      <td>44.176471</td>\n      <td>29.352941</td>\n      <td>279.176471</td>\n      <td>1.529412</td>\n      <td>0.588235</td>\n      <td>22.705882</td>\n      <td>76.941176</td>\n      <td>...</td>\n      <td>2.588235</td>\n      <td>5.235294</td>\n      <td>3.470588</td>\n      <td>0.588235</td>\n      <td>0.058824</td>\n      <td>0.705882</td>\n      <td>0.588235</td>\n      <td>0.000000</td>\n      <td>0.058824</td>\n      <td>0.501730</td>\n    </tr>\n    <tr>\n      <th>Tennessee Titans</th>\n      <td>0.411765</td>\n      <td>0.588235</td>\n      <td>0.000000</td>\n      <td>26.823529</td>\n      <td>16.764706</td>\n      <td>189.823529</td>\n      <td>0.941176</td>\n      <td>0.647059</td>\n      <td>28.647059</td>\n      <td>125.352941</td>\n      <td>...</td>\n      <td>2.294118</td>\n      <td>4.470588</td>\n      <td>4.588235</td>\n      <td>0.823529</td>\n      <td>0.058824</td>\n      <td>0.647059</td>\n      <td>0.352941</td>\n      <td>0.058824</td>\n      <td>0.058824</td>\n      <td>0.494810</td>\n    </tr>\n    <tr>\n      <th>Washington Commanders</th>\n      <td>0.470588</td>\n      <td>0.470588</td>\n      <td>0.058824</td>\n      <td>32.588235</td>\n      <td>20.235294</td>\n      <td>222.529412</td>\n      <td>1.411765</td>\n      <td>0.941176</td>\n      <td>31.647059</td>\n      <td>126.058824</td>\n      <td>...</td>\n      <td>2.529412</td>\n      <td>5.235294</td>\n      <td>4.000000</td>\n      <td>0.529412</td>\n      <td>0.117647</td>\n      <td>0.529412</td>\n      <td>0.529412</td>\n      <td>0.058824</td>\n      <td>0.058824</td>\n      <td>0.529412</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 35 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 49,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761803792
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = stats.reset_index()"
      ],
      "outputs": [],
      "execution_count": 50,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761804130
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = add_superbowl(stats, \"Year\", \"Team\")\n",
        "stats"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 51,
          "data": {
            "text/plain": "     Year                   Team      Wins    Losses      Ties  \\\n0    2004      Arizona Cardinals  0.375000  0.625000  0.000000   \n1    2004        Atlanta Falcons  0.687500  0.312500  0.000000   \n2    2004       Baltimore Ravens  0.562500  0.437500  0.000000   \n3    2004          Buffalo Bills  0.562500  0.437500  0.000000   \n4    2004      Carolina Panthers  0.437500  0.562500  0.000000   \n..    ...                    ...       ...       ...       ...   \n603  2022    San Francisco 49ers  0.764706  0.235294  0.000000   \n604  2022       Seattle Seahawks  0.529412  0.470588  0.000000   \n605  2022   Tampa Bay Buccaneers  0.470588  0.529412  0.000000   \n606  2022       Tennessee Titans  0.411765  0.588235  0.000000   \n607  2022  Washington Commanders  0.470588  0.470588  0.058824   \n\n     Passing_Attempts  Passing_Completions  Passing_Yards  Passing_TDs  \\\n0           33.312500            18.687500     200.125000     0.875000   \n1           24.687500            13.562500     168.250000     0.937500   \n2           29.062500            16.125000     159.937500     0.812500   \n3           28.812500            16.375000     189.500000     1.312500   \n4           33.500000            19.437500     243.062500     1.812500   \n..                ...                  ...            ...          ...   \n603         30.117647            19.882353     259.352941     1.764706   \n604         33.705882            23.470588     251.882353     1.764706   \n605         44.176471            29.352941     279.176471     1.529412   \n606         26.823529            16.764706     189.823529     0.941176   \n607         32.588235            20.235294     222.529412     1.411765   \n\n     Interceptions_Thrown  ...  Tackles_For_Loss  Pass_Deflections  \\\n0                1.125000  ...          0.000000         14.625000   \n1                1.000000  ...          0.000000         11.812500   \n2                0.687500  ...          0.000000         14.062500   \n3                1.062500  ...          0.000000         14.062500   \n4                0.937500  ...          0.000000         13.125000   \n..                    ...  ...               ...               ...   \n603              0.529412  ...          4.529412          4.588235   \n604              0.705882  ...          4.411765          4.764706   \n605              0.588235  ...          5.235294          3.470588   \n606              0.647059  ...          4.470588          4.588235   \n607              0.941176  ...          5.235294          4.000000   \n\n     Interceptions  Interception_TDs  Forced_Fumbles  Fumbles_Recovered  \\\n0         0.937500          0.062500        1.250000           0.000000   \n1         1.187500          0.250000        1.187500           0.000000   \n2         1.312500          0.312500        1.062500           0.000000   \n3         1.500000          0.250000        1.312500           0.000000   \n4         1.625000          0.125000        1.187500           0.000000   \n..             ...               ...             ...                ...   \n603       1.176471          0.117647        1.117647           0.588235   \n604       0.823529          0.058824        1.235294           0.647059   \n605       0.588235          0.058824        0.705882           0.588235   \n606       0.823529          0.058824        0.647059           0.352941   \n607       0.529412          0.117647        0.529412           0.529412   \n\n     Fumble__TDs  Kicks_Blocked  avg opp wins  Superbowl Status  \n0       0.062500       0.125000      0.460938                 0  \n1       0.062500       0.125000      0.433594                 0  \n2       0.125000       0.000000      0.550781                 0  \n3       0.000000       0.062500      0.511719                 0  \n4       0.062500       0.125000      0.507812                 0  \n..           ...            ...           ...               ...  \n603     0.058824       0.000000      0.415225                 0  \n604     0.000000       0.058824      0.460208                 0  \n605     0.000000       0.058824      0.501730                 0  \n606     0.058824       0.058824      0.494810                 0  \n607     0.058824       0.058824      0.529412                 0  \n\n[608 rows x 38 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Year</th>\n      <th>Team</th>\n      <th>Wins</th>\n      <th>Losses</th>\n      <th>Ties</th>\n      <th>Passing_Attempts</th>\n      <th>Passing_Completions</th>\n      <th>Passing_Yards</th>\n      <th>Passing_TDs</th>\n      <th>Interceptions_Thrown</th>\n      <th>...</th>\n      <th>Tackles_For_Loss</th>\n      <th>Pass_Deflections</th>\n      <th>Interceptions</th>\n      <th>Interception_TDs</th>\n      <th>Forced_Fumbles</th>\n      <th>Fumbles_Recovered</th>\n      <th>Fumble__TDs</th>\n      <th>Kicks_Blocked</th>\n      <th>avg opp wins</th>\n      <th>Superbowl Status</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2004</td>\n      <td>Arizona Cardinals</td>\n      <td>0.375000</td>\n      <td>0.625000</td>\n      <td>0.000000</td>\n      <td>33.312500</td>\n      <td>18.687500</td>\n      <td>200.125000</td>\n      <td>0.875000</td>\n      <td>1.125000</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>14.625000</td>\n      <td>0.937500</td>\n      <td>0.062500</td>\n      <td>1.250000</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.460938</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2004</td>\n      <td>Atlanta Falcons</td>\n      <td>0.687500</td>\n      <td>0.312500</td>\n      <td>0.000000</td>\n      <td>24.687500</td>\n      <td>13.562500</td>\n      <td>168.250000</td>\n      <td>0.937500</td>\n      <td>1.000000</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>11.812500</td>\n      <td>1.187500</td>\n      <td>0.250000</td>\n      <td>1.187500</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.433594</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2004</td>\n      <td>Baltimore Ravens</td>\n      <td>0.562500</td>\n      <td>0.437500</td>\n      <td>0.000000</td>\n      <td>29.062500</td>\n      <td>16.125000</td>\n      <td>159.937500</td>\n      <td>0.812500</td>\n      <td>0.687500</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>14.062500</td>\n      <td>1.312500</td>\n      <td>0.312500</td>\n      <td>1.062500</td>\n      <td>0.000000</td>\n      <td>0.125000</td>\n      <td>0.000000</td>\n      <td>0.550781</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2004</td>\n      <td>Buffalo Bills</td>\n      <td>0.562500</td>\n      <td>0.437500</td>\n      <td>0.000000</td>\n      <td>28.812500</td>\n      <td>16.375000</td>\n      <td>189.500000</td>\n      <td>1.312500</td>\n      <td>1.062500</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>14.062500</td>\n      <td>1.500000</td>\n      <td>0.250000</td>\n      <td>1.312500</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.511719</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2004</td>\n      <td>Carolina Panthers</td>\n      <td>0.437500</td>\n      <td>0.562500</td>\n      <td>0.000000</td>\n      <td>33.500000</td>\n      <td>19.437500</td>\n      <td>243.062500</td>\n      <td>1.812500</td>\n      <td>0.937500</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>13.125000</td>\n      <td>1.625000</td>\n      <td>0.125000</td>\n      <td>1.187500</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.507812</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>603</th>\n      <td>2022</td>\n      <td>San Francisco 49ers</td>\n      <td>0.764706</td>\n      <td>0.235294</td>\n      <td>0.000000</td>\n      <td>30.117647</td>\n      <td>19.882353</td>\n      <td>259.352941</td>\n      <td>1.764706</td>\n      <td>0.529412</td>\n      <td>...</td>\n      <td>4.529412</td>\n      <td>4.588235</td>\n      <td>1.176471</td>\n      <td>0.117647</td>\n      <td>1.117647</td>\n      <td>0.588235</td>\n      <td>0.058824</td>\n      <td>0.000000</td>\n      <td>0.415225</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>604</th>\n      <td>2022</td>\n      <td>Seattle Seahawks</td>\n      <td>0.529412</td>\n      <td>0.470588</td>\n      <td>0.000000</td>\n      <td>33.705882</td>\n      <td>23.470588</td>\n      <td>251.882353</td>\n      <td>1.764706</td>\n      <td>0.705882</td>\n      <td>...</td>\n      <td>4.411765</td>\n      <td>4.764706</td>\n      <td>0.823529</td>\n      <td>0.058824</td>\n      <td>1.235294</td>\n      <td>0.647059</td>\n      <td>0.000000</td>\n      <td>0.058824</td>\n      <td>0.460208</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>605</th>\n      <td>2022</td>\n      <td>Tampa Bay Buccaneers</td>\n      <td>0.470588</td>\n      <td>0.529412</td>\n      <td>0.000000</td>\n      <td>44.176471</td>\n      <td>29.352941</td>\n      <td>279.176471</td>\n      <td>1.529412</td>\n      <td>0.588235</td>\n      <td>...</td>\n      <td>5.235294</td>\n      <td>3.470588</td>\n      <td>0.588235</td>\n      <td>0.058824</td>\n      <td>0.705882</td>\n      <td>0.588235</td>\n      <td>0.000000</td>\n      <td>0.058824</td>\n      <td>0.501730</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>606</th>\n      <td>2022</td>\n      <td>Tennessee Titans</td>\n      <td>0.411765</td>\n      <td>0.588235</td>\n      <td>0.000000</td>\n      <td>26.823529</td>\n      <td>16.764706</td>\n      <td>189.823529</td>\n      <td>0.941176</td>\n      <td>0.647059</td>\n      <td>...</td>\n      <td>4.470588</td>\n      <td>4.588235</td>\n      <td>0.823529</td>\n      <td>0.058824</td>\n      <td>0.647059</td>\n      <td>0.352941</td>\n      <td>0.058824</td>\n      <td>0.058824</td>\n      <td>0.494810</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>607</th>\n      <td>2022</td>\n      <td>Washington Commanders</td>\n      <td>0.470588</td>\n      <td>0.470588</td>\n      <td>0.058824</td>\n      <td>32.588235</td>\n      <td>20.235294</td>\n      <td>222.529412</td>\n      <td>1.411765</td>\n      <td>0.941176</td>\n      <td>...</td>\n      <td>5.235294</td>\n      <td>4.000000</td>\n      <td>0.529412</td>\n      <td>0.117647</td>\n      <td>0.529412</td>\n      <td>0.529412</td>\n      <td>0.058824</td>\n      <td>0.058824</td>\n      <td>0.529412</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 38 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 51,
      "metadata": {
        "jupyter": {
          "outputs_hidden": false,
          "source_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761804489
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats = stats.set_index([\"Year\", \"Team\"])"
      ],
      "outputs": [],
      "execution_count": 52,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761804776
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 53,
          "data": {
            "text/plain": "                                Wins    Losses      Ties  Passing_Attempts  \\\nYear Team                                                                    \n2004 Arizona Cardinals      0.375000  0.625000  0.000000         33.312500   \n     Atlanta Falcons        0.687500  0.312500  0.000000         24.687500   \n     Baltimore Ravens       0.562500  0.437500  0.000000         29.062500   \n     Buffalo Bills          0.562500  0.437500  0.000000         28.812500   \n     Carolina Panthers      0.437500  0.562500  0.000000         33.500000   \n...                              ...       ...       ...               ...   \n2022 San Francisco 49ers    0.764706  0.235294  0.000000         30.117647   \n     Seattle Seahawks       0.529412  0.470588  0.000000         33.705882   \n     Tampa Bay Buccaneers   0.470588  0.529412  0.000000         44.176471   \n     Tennessee Titans       0.411765  0.588235  0.000000         26.823529   \n     Washington Commanders  0.470588  0.470588  0.058824         32.588235   \n\n                            Passing_Completions  Passing_Yards  Passing_TDs  \\\nYear Team                                                                     \n2004 Arizona Cardinals                18.687500     200.125000     0.875000   \n     Atlanta Falcons                  13.562500     168.250000     0.937500   \n     Baltimore Ravens                 16.125000     159.937500     0.812500   \n     Buffalo Bills                    16.375000     189.500000     1.312500   \n     Carolina Panthers                19.437500     243.062500     1.812500   \n...                                         ...            ...          ...   \n2022 San Francisco 49ers              19.882353     259.352941     1.764706   \n     Seattle Seahawks                 23.470588     251.882353     1.764706   \n     Tampa Bay Buccaneers             29.352941     279.176471     1.529412   \n     Tennessee Titans                 16.764706     189.823529     0.941176   \n     Washington Commanders            20.235294     222.529412     1.411765   \n\n                            Interceptions_Thrown  Rushing _Attempts  \\\nYear Team                                                             \n2004 Arizona Cardinals                  1.125000          29.687500   \n     Atlanta Falcons                    1.000000          32.750000   \n     Baltimore Ravens                   0.687500          30.687500   \n     Buffalo Bills                      1.062500          30.187500   \n     Carolina Panthers                  0.937500          26.375000   \n...                                          ...                ...   \n2022 San Francisco 49ers                0.529412          29.647059   \n     Seattle Seahawks                   0.705882          25.000000   \n     Tampa Bay Buccaneers               0.588235          22.705882   \n     Tennessee Titans                   0.647059          28.647059   \n     Washington Commanders              0.941176          31.647059   \n\n                            Rushing_Yards  ...  Tackles_For_Loss  \\\nYear Team                                  ...                     \n2004 Arizona Cardinals         104.250000  ...          0.000000   \n     Atlanta Falcons           167.000000  ...          0.000000   \n     Baltimore Ravens          128.937500  ...          0.000000   \n     Buffalo Bills             117.125000  ...          0.000000   \n     Carolina Panthers          98.875000  ...          0.000000   \n...                                   ...  ...               ...   \n2022 San Francisco 49ers       138.823529  ...          4.529412   \n     Seattle Seahawks          120.117647  ...          4.411765   \n     Tampa Bay Buccaneers       76.941176  ...          5.235294   \n     Tennessee Titans          125.352941  ...          4.470588   \n     Washington Commanders     126.058824  ...          5.235294   \n\n                            Pass_Deflections  Interceptions  Interception_TDs  \\\nYear Team                                                                       \n2004 Arizona Cardinals             14.625000       0.937500          0.062500   \n     Atlanta Falcons               11.812500       1.187500          0.250000   \n     Baltimore Ravens              14.062500       1.312500          0.312500   \n     Buffalo Bills                 14.062500       1.500000          0.250000   \n     Carolina Panthers             13.125000       1.625000          0.125000   \n...                                      ...            ...               ...   \n2022 San Francisco 49ers            4.588235       1.176471          0.117647   \n     Seattle Seahawks               4.764706       0.823529          0.058824   \n     Tampa Bay Buccaneers           3.470588       0.588235          0.058824   \n     Tennessee Titans               4.588235       0.823529          0.058824   \n     Washington Commanders          4.000000       0.529412          0.117647   \n\n                            Forced_Fumbles  Fumbles_Recovered  Fumble__TDs  \\\nYear Team                                                                    \n2004 Arizona Cardinals            1.250000           0.000000     0.062500   \n     Atlanta Falcons              1.187500           0.000000     0.062500   \n     Baltimore Ravens             1.062500           0.000000     0.125000   \n     Buffalo Bills                1.312500           0.000000     0.000000   \n     Carolina Panthers            1.187500           0.000000     0.062500   \n...                                    ...                ...          ...   \n2022 San Francisco 49ers          1.117647           0.588235     0.058824   \n     Seattle Seahawks             1.235294           0.647059     0.000000   \n     Tampa Bay Buccaneers         0.705882           0.588235     0.000000   \n     Tennessee Titans             0.647059           0.352941     0.058824   \n     Washington Commanders        0.529412           0.529412     0.058824   \n\n                            Kicks_Blocked  avg opp wins  Superbowl Status  \nYear Team                                                                  \n2004 Arizona Cardinals           0.125000      0.460938                 0  \n     Atlanta Falcons             0.125000      0.433594                 0  \n     Baltimore Ravens            0.000000      0.550781                 0  \n     Buffalo Bills               0.062500      0.511719                 0  \n     Carolina Panthers           0.125000      0.507812                 0  \n...                                   ...           ...               ...  \n2022 San Francisco 49ers         0.000000      0.415225                 0  \n     Seattle Seahawks            0.058824      0.460208                 0  \n     Tampa Bay Buccaneers        0.058824      0.501730                 0  \n     Tennessee Titans            0.058824      0.494810                 0  \n     Washington Commanders       0.058824      0.529412                 0  \n\n[608 rows x 36 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>Wins</th>\n      <th>Losses</th>\n      <th>Ties</th>\n      <th>Passing_Attempts</th>\n      <th>Passing_Completions</th>\n      <th>Passing_Yards</th>\n      <th>Passing_TDs</th>\n      <th>Interceptions_Thrown</th>\n      <th>Rushing _Attempts</th>\n      <th>Rushing_Yards</th>\n      <th>...</th>\n      <th>Tackles_For_Loss</th>\n      <th>Pass_Deflections</th>\n      <th>Interceptions</th>\n      <th>Interception_TDs</th>\n      <th>Forced_Fumbles</th>\n      <th>Fumbles_Recovered</th>\n      <th>Fumble__TDs</th>\n      <th>Kicks_Blocked</th>\n      <th>avg opp wins</th>\n      <th>Superbowl Status</th>\n    </tr>\n    <tr>\n      <th>Year</th>\n      <th>Team</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2004</th>\n      <th>Arizona Cardinals</th>\n      <td>0.375000</td>\n      <td>0.625000</td>\n      <td>0.000000</td>\n      <td>33.312500</td>\n      <td>18.687500</td>\n      <td>200.125000</td>\n      <td>0.875000</td>\n      <td>1.125000</td>\n      <td>29.687500</td>\n      <td>104.250000</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>14.625000</td>\n      <td>0.937500</td>\n      <td>0.062500</td>\n      <td>1.250000</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.460938</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Atlanta Falcons</th>\n      <td>0.687500</td>\n      <td>0.312500</td>\n      <td>0.000000</td>\n      <td>24.687500</td>\n      <td>13.562500</td>\n      <td>168.250000</td>\n      <td>0.937500</td>\n      <td>1.000000</td>\n      <td>32.750000</td>\n      <td>167.000000</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>11.812500</td>\n      <td>1.187500</td>\n      <td>0.250000</td>\n      <td>1.187500</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.433594</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Baltimore Ravens</th>\n      <td>0.562500</td>\n      <td>0.437500</td>\n      <td>0.000000</td>\n      <td>29.062500</td>\n      <td>16.125000</td>\n      <td>159.937500</td>\n      <td>0.812500</td>\n      <td>0.687500</td>\n      <td>30.687500</td>\n      <td>128.937500</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>14.062500</td>\n      <td>1.312500</td>\n      <td>0.312500</td>\n      <td>1.062500</td>\n      <td>0.000000</td>\n      <td>0.125000</td>\n      <td>0.000000</td>\n      <td>0.550781</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Buffalo Bills</th>\n      <td>0.562500</td>\n      <td>0.437500</td>\n      <td>0.000000</td>\n      <td>28.812500</td>\n      <td>16.375000</td>\n      <td>189.500000</td>\n      <td>1.312500</td>\n      <td>1.062500</td>\n      <td>30.187500</td>\n      <td>117.125000</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>14.062500</td>\n      <td>1.500000</td>\n      <td>0.250000</td>\n      <td>1.312500</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.511719</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Carolina Panthers</th>\n      <td>0.437500</td>\n      <td>0.562500</td>\n      <td>0.000000</td>\n      <td>33.500000</td>\n      <td>19.437500</td>\n      <td>243.062500</td>\n      <td>1.812500</td>\n      <td>0.937500</td>\n      <td>26.375000</td>\n      <td>98.875000</td>\n      <td>...</td>\n      <td>0.000000</td>\n      <td>13.125000</td>\n      <td>1.625000</td>\n      <td>0.125000</td>\n      <td>1.187500</td>\n      <td>0.000000</td>\n      <td>0.062500</td>\n      <td>0.125000</td>\n      <td>0.507812</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2022</th>\n      <th>San Francisco 49ers</th>\n      <td>0.764706</td>\n      <td>0.235294</td>\n      <td>0.000000</td>\n      <td>30.117647</td>\n      <td>19.882353</td>\n      <td>259.352941</td>\n      <td>1.764706</td>\n      <td>0.529412</td>\n      <td>29.647059</td>\n      <td>138.823529</td>\n      <td>...</td>\n      <td>4.529412</td>\n      <td>4.588235</td>\n      <td>1.176471</td>\n      <td>0.117647</td>\n      <td>1.117647</td>\n      <td>0.588235</td>\n      <td>0.058824</td>\n      <td>0.000000</td>\n      <td>0.415225</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Seattle Seahawks</th>\n      <td>0.529412</td>\n      <td>0.470588</td>\n      <td>0.000000</td>\n      <td>33.705882</td>\n      <td>23.470588</td>\n      <td>251.882353</td>\n      <td>1.764706</td>\n      <td>0.705882</td>\n      <td>25.000000</td>\n      <td>120.117647</td>\n      <td>...</td>\n      <td>4.411765</td>\n      <td>4.764706</td>\n      <td>0.823529</td>\n      <td>0.058824</td>\n      <td>1.235294</td>\n      <td>0.647059</td>\n      <td>0.000000</td>\n      <td>0.058824</td>\n      <td>0.460208</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Tampa Bay Buccaneers</th>\n      <td>0.470588</td>\n      <td>0.529412</td>\n      <td>0.000000</td>\n      <td>44.176471</td>\n      <td>29.352941</td>\n      <td>279.176471</td>\n      <td>1.529412</td>\n      <td>0.588235</td>\n      <td>22.705882</td>\n      <td>76.941176</td>\n      <td>...</td>\n      <td>5.235294</td>\n      <td>3.470588</td>\n      <td>0.588235</td>\n      <td>0.058824</td>\n      <td>0.705882</td>\n      <td>0.588235</td>\n      <td>0.000000</td>\n      <td>0.058824</td>\n      <td>0.501730</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Tennessee Titans</th>\n      <td>0.411765</td>\n      <td>0.588235</td>\n      <td>0.000000</td>\n      <td>26.823529</td>\n      <td>16.764706</td>\n      <td>189.823529</td>\n      <td>0.941176</td>\n      <td>0.647059</td>\n      <td>28.647059</td>\n      <td>125.352941</td>\n      <td>...</td>\n      <td>4.470588</td>\n      <td>4.588235</td>\n      <td>0.823529</td>\n      <td>0.058824</td>\n      <td>0.647059</td>\n      <td>0.352941</td>\n      <td>0.058824</td>\n      <td>0.058824</td>\n      <td>0.494810</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Washington Commanders</th>\n      <td>0.470588</td>\n      <td>0.470588</td>\n      <td>0.058824</td>\n      <td>32.588235</td>\n      <td>20.235294</td>\n      <td>222.529412</td>\n      <td>1.411765</td>\n      <td>0.941176</td>\n      <td>31.647059</td>\n      <td>126.058824</td>\n      <td>...</td>\n      <td>5.235294</td>\n      <td>4.000000</td>\n      <td>0.529412</td>\n      <td>0.117647</td>\n      <td>0.529412</td>\n      <td>0.529412</td>\n      <td>0.058824</td>\n      <td>0.058824</td>\n      <td>0.529412</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 36 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 53,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761805179
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "features = stats[stats.columns[0:36]]"
      ],
      "outputs": [],
      "execution_count": 54,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761805443
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "pca = PCA(n_components = 1, whiten = True)\n",
        "pca = pca.fit(features)\n",
        "pca = pca.set_output(transform = \"pandas\")\n",
        "\n",
        "pca_features = pca.transform(features)\n",
        "\n",
        "np.sum(pca.explained_variance_ratio_)"
      ],
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": "/anaconda/envs/azureml_py310_sdkv2/lib/python3.10/site-packages/sklearn/utils/validation.py:767: FutureWarning: is_sparse is deprecated and will be removed in a future version. Check `isinstance(dtype, pd.SparseDtype)` instead.\n  if not hasattr(array, \"sparse\") and array.dtypes.apply(is_sparse).any():\n/anaconda/envs/azureml_py310_sdkv2/lib/python3.10/site-packages/sklearn/utils/validation.py:605: FutureWarning: is_sparse is deprecated and will be removed in a future version. Check `isinstance(dtype, pd.SparseDtype)` instead.\n  if is_sparse(pd_dtype):\n/anaconda/envs/azureml_py310_sdkv2/lib/python3.10/site-packages/sklearn/utils/validation.py:614: FutureWarning: is_sparse is deprecated and will be removed in a future version. Check `isinstance(dtype, pd.SparseDtype)` instead.\n  if is_sparse(pd_dtype) or not is_extension_array_dtype(pd_dtype):\n/anaconda/envs/azureml_py310_sdkv2/lib/python3.10/site-packages/sklearn/utils/validation.py:767: FutureWarning: is_sparse is deprecated and will be removed in a future version. Check `isinstance(dtype, pd.SparseDtype)` instead.\n  if not hasattr(array, \"sparse\") and array.dtypes.apply(is_sparse).any():\n/anaconda/envs/azureml_py310_sdkv2/lib/python3.10/site-packages/sklearn/utils/validation.py:605: FutureWarning: is_sparse is deprecated and will be removed in a future version. Check `isinstance(dtype, pd.SparseDtype)` instead.\n  if is_sparse(pd_dtype):\n/anaconda/envs/azureml_py310_sdkv2/lib/python3.10/site-packages/sklearn/utils/validation.py:614: FutureWarning: is_sparse is deprecated and will be removed in a future version. Check `isinstance(dtype, pd.SparseDtype)` instead.\n  if is_sparse(pd_dtype) or not is_extension_array_dtype(pd_dtype):\n"
        },
        {
          "output_type": "execute_result",
          "execution_count": 55,
          "data": {
            "text/plain": "0.8570207750439125"
          },
          "metadata": {}
        }
      ],
      "execution_count": 55,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761805745
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "pca_stats = pd.concat([pca_features, stats[\"Superbowl Status\"]], axis = 1)"
      ],
      "outputs": [],
      "execution_count": 56,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761805956
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "pca_stats"
      ],
      "outputs": [
        {
          "output_type": "execute_result",
          "execution_count": 57,
          "data": {
            "text/plain": "                                pca0  Superbowl Status\nYear Team                                             \n2004 Arizona Cardinals     -1.032069                 0\n     Atlanta Falcons       -2.054910                 0\n     Baltimore Ravens      -2.155896                 0\n     Buffalo Bills         -1.351537                 0\n     Carolina Panthers      0.102083                 0\n...                              ...               ...\n2022 San Francisco 49ers    0.142975                 0\n     Seattle Seahawks       0.285417                 0\n     Tampa Bay Buccaneers   1.139544                 0\n     Tennessee Titans      -1.364615                 0\n     Washington Commanders -0.500444                 0\n\n[608 rows x 2 columns]",
            "text/html": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>pca0</th>\n      <th>Superbowl Status</th>\n    </tr>\n    <tr>\n      <th>Year</th>\n      <th>Team</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2004</th>\n      <th>Arizona Cardinals</th>\n      <td>-1.032069</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Atlanta Falcons</th>\n      <td>-2.054910</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Baltimore Ravens</th>\n      <td>-2.155896</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Buffalo Bills</th>\n      <td>-1.351537</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Carolina Panthers</th>\n      <td>0.102083</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th rowspan=\"5\" valign=\"top\">2022</th>\n      <th>San Francisco 49ers</th>\n      <td>0.142975</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Seattle Seahawks</th>\n      <td>0.285417</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Tampa Bay Buccaneers</th>\n      <td>1.139544</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Tennessee Titans</th>\n      <td>-1.364615</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>Washington Commanders</th>\n      <td>-0.500444</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>608 rows × 2 columns</p>\n</div>"
          },
          "metadata": {}
        }
      ],
      "execution_count": 57,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761806204
        }
      }
    },
    {
      "cell_type": "code",
      "source": [
        "stats.to_csv(\"../data/processed/NFL_stats.csv\")\n",
        "pca_stats.to_csv(\"../data/processed/PCA_NFL_stats.csv\")"
      ],
      "outputs": [],
      "execution_count": 58,
      "metadata": {
        "jupyter": {
          "source_hidden": false,
          "outputs_hidden": false
        },
        "nteract": {
          "transient": {
            "deleting": false
          }
        },
        "gather": {
          "logged": 1704761806479
        }
      }
    }
  ],
  "metadata": {
    "kernel_info": {
      "name": "python310-sdkv2"
    },
    "kernelspec": {
      "name": "python310-sdkv2",
      "language": "python",
      "display_name": "Python 3.10 - SDK v2"
    },
    "language_info": {
      "name": "python",
      "version": "3.10.11",
      "mimetype": "text/x-python",
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "pygments_lexer": "ipython3",
      "nbconvert_exporter": "python",
      "file_extension": ".py"
    },
    "microsoft": {
      "host": {
        "AzureML": {
          "notebookHasBeenCompleted": true
        }
      },
      "ms_spell_check": {
        "ms_spell_check_language": "en"
      }
    },
    "nteract": {
      "version": "nteract-front-end@1.0.0"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 2
}